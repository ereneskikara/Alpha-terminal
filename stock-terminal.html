<!DOCTYPE html>
<html lang="tr" data-theme="dark">
<head>
<meta charset="UTF-8"/>
<meta name="viewport" content="width=device-width, initial-scale=1.0, viewport-fit=cover"/>
<meta name="apple-mobile-web-app-capable" content="yes"/>
<meta name="apple-mobile-web-app-status-bar-style" content="black-translucent"/>
<title>AlphaTerminal</title>
<link href="https://fonts.googleapis.com/css2?family=Roboto:wght@300;400;500;700&family=Roboto+Mono:wght@400;500;600;700&display=swap" rel="stylesheet"/>
<style>
/* DARK */
[data-theme="dark"]{
  --bg:#131722;--bg2:#1e222d;--bg3:#2a2e39;--bg4:#363c4e;
  --border:#2a2e39;--border2:#363c4e;
  --text:#d1d4dc;--text2:#787b86;--text3:#434651;
  --card:#1e222d;--header:#1e222d;
  --accent:#2962ff;--accent2:#00bcd4;
  --up:#26a69a;--down:#ef5350;--gold:#f59e0b;--warn:#f59e0b;
  --shadow:rgba(0,0,0,.4);--overlay:rgba(0,0,0,.85);
  --modal-bg:#1e222d;--input-bg:#2a2e39;
}
/* DIM */
[data-theme="dim"]{
  --bg:#1c2030;--bg2:#232738;--bg3:#2b2f45;--bg4:#353a52;
  --border:#2b2f45;--border2:#353a52;
  --text:#b2b5be;--text2:#6b7280;--text3:#414960;
  --card:#232738;--header:#232738;
  --accent:#4e74ff;--accent2:#26c6da;
  --up:#4caf87;--down:#e57373;--gold:#fbbf24;--warn:#fbbf24;
  --shadow:rgba(0,0,0,.5);--overlay:rgba(0,0,0,.8);
  --modal-bg:#232738;--input-bg:#2b2f45;
}
/* LIGHT */
[data-theme="light"]{
  --bg:#f0f3fa;--bg2:#ffffff;--bg3:#f0f3fa;--bg4:#e0e3eb;
  --border:#e0e3eb;--border2:#c8cbcf;
  --text:#131722;--text2:#787b86;--text3:#a3a6af;
  --card:#ffffff;--header:#ffffff;
  --accent:#2962ff;--accent2:#0097a7;
  --up:#26a69a;--down:#ef5350;--gold:#d4a017;--warn:#d4a017;
  --shadow:rgba(0,0,0,.1);--overlay:rgba(0,0,0,.6);
  --modal-bg:#ffffff;--input-bg:#f0f3fa;
}

*{margin:0;padding:0;box-sizing:border-box;-webkit-tap-highlight-color:transparent;}
html,body{height:100%;background:var(--bg);color:var(--text);font-family:'Roboto',sans-serif;overflow:hidden;font-size:13px;}
body,header,nav,.bottom-nav,.card,.modal,.setting-group,.ind-item,.mkt-item,.val-item,.fib-table,.ai-box,.opp-card,.wl-item,.board-item,.news-item,.unusual-item,.tab,.bnav,.sri,.exch-btn,.btn-icon,.btn-sec,.wl-chip{transition:background .25s,color .25s,border-color .25s;}

#app{position:relative;z-index:1;height:100dvh;display:flex;flex-direction:column;padding-top:env(safe-area-inset-top);}

/* HEADER */
header{height:46px;padding:0 12px;display:flex;align-items:center;justify-content:space-between;border-bottom:1px solid var(--border);background:var(--header);flex-shrink:0;}
.logo{font-family:'Roboto Mono',monospace;font-size:13px;font-weight:700;color:var(--text);display:flex;align-items:center;gap:8px;}
.logo-mark{width:24px;height:24px;background:var(--accent);border-radius:4px;display:flex;align-items:center;justify-content:center;font-size:12px;font-weight:700;color:#fff;}
.logo-name{font-weight:700;} .logo-name span{color:var(--text2);font-weight:400;}
.h-right{display:flex;gap:6px;align-items:center;}
.live-pill{display:flex;align-items:center;gap:4px;padding:3px 8px;background:rgba(38,166,154,.1);border:1px solid rgba(38,166,154,.25);border-radius:3px;}
.live-dot{width:5px;height:5px;border-radius:50%;background:var(--up);animation:liveblink 2s infinite;}
@keyframes liveblink{0%,100%{opacity:1;box-shadow:0 0 0 0 rgba(38,166,154,.5)}50%{opacity:.5;box-shadow:0 0 0 4px rgba(38,166,154,0)}}
.live-lbl{font-family:'Roboto Mono',monospace;font-size:9px;color:var(--up);letter-spacing:1.5px;font-weight:600;}
.h-clock{font-family:'Roboto Mono',monospace;font-size:10px;color:var(--text2);}
.h-btn{width:30px;height:30px;display:flex;align-items:center;justify-content:center;border-radius:4px;cursor:pointer;font-size:16px;background:transparent;border:none;color:var(--text2);}
.h-btn:hover{background:var(--bg3);}

/* TICKER BAR */
.ticker-bar{height:36px;display:flex;border-bottom:1px solid var(--border);background:var(--header);overflow-x:auto;scrollbar-width:none;flex-shrink:0;align-items:stretch;}
.ticker-bar::-webkit-scrollbar{display:none;}
.tb-item{display:flex;flex-direction:column;justify-content:center;padding:0 12px;border-right:1px solid var(--border);min-width:fit-content;cursor:pointer;flex-shrink:0;position:relative;gap:1px;}
.tb-item:hover{background:var(--bg3);}
.tb-item.active::after{content:'';position:absolute;bottom:0;left:0;right:0;height:2px;background:var(--accent);}
.tb-sym{font-family:'Roboto Mono',monospace;font-size:11px;font-weight:600;color:var(--text);}
.tb-price{font-family:'Roboto Mono',monospace;font-size:10px;}
.tb-chg{font-family:'Roboto Mono',monospace;font-size:9px;}
.up{color:var(--up);}.down{color:var(--down);}

/* NAV */
nav{display:flex;border-bottom:1px solid var(--border);background:var(--header);overflow-x:auto;scrollbar-width:none;flex-shrink:0;}
nav::-webkit-scrollbar{display:none;}
.tab{padding:0 14px;height:36px;font-size:12px;font-weight:500;color:var(--text2);white-space:nowrap;cursor:pointer;border-bottom:2px solid transparent;display:flex;align-items:center;transition:color .15s,border-color .15s,background .15s;}
.tab.active{color:var(--text);border-bottom-color:var(--accent);}
.tab:hover:not(.active){color:var(--text);background:var(--bg3);}

/* MAIN */
main{flex:1;overflow-y:auto;overflow-x:hidden;padding:12px;padding-bottom:76px;}
main::-webkit-scrollbar{width:3px;}
main::-webkit-scrollbar-thumb{background:var(--border2);border-radius:2px;}

/* CARD */
.card{background:var(--card);border:1px solid var(--border);border-radius:4px;padding:12px;margin-bottom:8px;}
.card-hdr{font-size:11px;font-weight:500;letter-spacing:.5px;color:var(--text2);margin-bottom:10px;display:flex;align-items:center;justify-content:space-between;text-transform:uppercase;}

/* WATCHLIST */
.wl-item{display:flex;align-items:center;justify-content:space-between;padding:8px 6px;border-radius:3px;cursor:pointer;margin-bottom:1px;}
.wl-item:hover{background:var(--bg3);}
.wl-item.selected{background:rgba(41,98,255,.1);}
.wl-item.selected .wl-sym{color:var(--accent);}
.wl-sym{font-family:'Roboto Mono',monospace;font-size:13px;font-weight:600;}
.wl-name{font-size:10px;color:var(--text3);max-width:130px;overflow:hidden;text-overflow:ellipsis;white-space:nowrap;margin-top:1px;}
.wl-price{font-family:'Roboto Mono',monospace;font-size:13px;font-weight:600;}
.wl-chg{font-family:'Roboto Mono',monospace;font-size:10px;padding:1px 5px;border-radius:2px;margin-top:2px;}
.wl-chg.up{background:rgba(38,166,154,.15);color:var(--up);}
.wl-chg.down{background:rgba(239,83,80,.15);color:var(--down);}
.sig-badge{font-size:9px;font-weight:700;padding:2px 5px;border-radius:2px;text-transform:uppercase;margin-left:3px;letter-spacing:.5px;}
.sig-buy{background:rgba(38,166,154,.2);color:var(--up);}
.sig-sell{background:rgba(239,83,80,.2);color:var(--down);}
.sig-hold{background:rgba(245,158,11,.15);color:var(--warn);}
.add-wl-btn{display:flex;align-items:center;gap:6px;padding:8px 10px;margin-top:6px;background:transparent;border:1px dashed var(--border2);border-radius:3px;cursor:pointer;color:var(--text2);font-size:12px;font-weight:500;}
.add-wl-btn:hover{border-color:var(--accent);color:var(--accent);background:rgba(41,98,255,.05);}

/* CHART */
canvas.minichart{width:100%;height:90px;display:block;border-radius:3px;}
.chart-meta{display:flex;justify-content:space-between;margin-top:4px;font-family:'Roboto Mono',monospace;font-size:9px;color:var(--text3);}

/* MARKET GRID */
.mkt-grid{display:grid;grid-template-columns:1fr 1fr;gap:6px;}
.mkt-item{background:var(--bg3);border:1px solid var(--border);border-radius:3px;padding:8px 10px;}
.mkt-label{font-size:9px;color:var(--text3);text-transform:uppercase;letter-spacing:.5px;margin-bottom:2px;}
.mkt-val{font-family:'Roboto Mono',monospace;font-size:14px;font-weight:600;}
.mkt-chg{font-family:'Roboto Mono',monospace;font-size:9px;margin-top:1px;}

/* SIGNAL */
.signal-hero{display:flex;align-items:center;justify-content:space-between;padding:8px 0 12px;}
.sig-lbl{font-family:'Roboto Mono',monospace;font-size:10px;color:var(--text2);margin-bottom:3px;text-transform:uppercase;letter-spacing:1px;}
.sig-action{font-family:'Roboto Mono',monospace;font-size:28px;font-weight:700;}
.sig-score-val{font-family:'Roboto Mono',monospace;font-size:26px;font-weight:700;color:var(--accent2);text-align:right;}
.sig-score-lbl{font-size:10px;color:var(--text3);text-align:right;text-transform:uppercase;letter-spacing:.5px;}
.sig-bar-wrap{height:3px;background:var(--bg3);border-radius:2px;overflow:hidden;margin-bottom:12px;}
.sig-bar-fill{height:100%;border-radius:2px;transition:width .6s ease;}
.reason{display:flex;align-items:flex-start;gap:7px;font-size:11px;color:var(--text2);padding:5px 8px;border-radius:3px;margin-bottom:4px;background:var(--bg3);line-height:1.5;}
.reason.bull{border-left:2px solid var(--up);}
.reason.bear{border-left:2px solid var(--down);}
.reason.neutral{border-left:2px solid var(--warn);}

/* INDICATORS */
.ind-grid{display:grid;grid-template-columns:1fr 1fr;gap:6px;}
.ind-item{background:var(--bg3);border:1px solid var(--border);border-radius:3px;padding:8px 10px;}
.ind-label{font-size:9px;color:var(--text3);text-transform:uppercase;letter-spacing:.5px;margin-bottom:2px;}
.ind-val{font-family:'Roboto Mono',monospace;font-size:15px;font-weight:600;}
.ind-status{font-size:9px;margin-top:1px;}

/* FIBONACCI */
.fib-table{width:100%;border-collapse:collapse;}
.fib-table tr{border-bottom:1px solid var(--border);}
.fib-table tr:last-child{border-bottom:none;}
.fib-table td{padding:5px 8px;font-family:'Roboto Mono',monospace;font-size:10px;}
.fib-table td:first-child{color:var(--text3);}
.fib-table td:last-child{text-align:right;font-weight:600;}
.fib-key td{color:var(--gold)!important;}

/* AI BOX */
.ai-box{background:var(--bg3);border:1px solid var(--border2);border-radius:3px;padding:10px;margin-bottom:8px;}
.ai-hdr{display:flex;align-items:center;gap:8px;margin-bottom:6px;}
.ai-badge{font-family:'Roboto Mono',monospace;font-size:9px;font-weight:600;letter-spacing:1.5px;color:var(--accent2);text-transform:uppercase;}
.ai-dots{display:flex;gap:3px;align-items:center;}
.ai-dot{width:4px;height:4px;border-radius:50%;background:var(--accent2);animation:blink 1.4s infinite;}
.ai-dot:nth-child(2){animation-delay:.2s;}.ai-dot:nth-child(3){animation-delay:.4s;}
@keyframes blink{0%,80%,100%{opacity:0}40%{opacity:1}}
.ai-text{font-size:12px;color:var(--text2);line-height:1.7;}
.timestamp{font-family:'Roboto Mono',monospace;font-size:9px;color:var(--text3);margin-top:6px;}

/* BUTTONS */
.btn-primary{background:var(--accent);color:#fff;border:none;border-radius:3px;padding:9px 14px;font-family:'Roboto',sans-serif;font-size:12px;font-weight:500;cursor:pointer;width:100%;letter-spacing:.3px;}
.btn-primary:hover{opacity:.85;}
.btn-sec{background:var(--bg3);color:var(--text2);border:1px solid var(--border2);border-radius:3px;padding:7px 12px;font-family:'Roboto',sans-serif;font-size:11px;font-weight:500;cursor:pointer;}
.btn-sec:hover{border-color:var(--accent);color:var(--accent);}
.btn-icon{background:var(--bg3);border:1px solid var(--border);border-radius:3px;padding:4px 8px;cursor:pointer;font-size:11px;color:var(--text2);}
.btn-icon:hover{border-color:var(--accent);color:var(--accent);}

/* NEWS */
.news-item{padding:8px 0;border-bottom:1px solid var(--border);cursor:pointer;}
.news-item:last-child{border-bottom:none;}
.news-top{display:flex;justify-content:space-between;align-items:flex-start;gap:8px;margin-bottom:3px;}
.news-title{font-size:12px;color:var(--text);line-height:1.4;font-weight:500;}
.imp{font-size:9px;font-weight:600;padding:2px 5px;border-radius:2px;white-space:nowrap;flex-shrink:0;text-transform:uppercase;}
.imp-high{background:rgba(239,83,80,.15);color:var(--down);}
.imp-med{background:rgba(245,158,11,.12);color:var(--warn);}
.imp-low{background:rgba(120,123,134,.15);color:var(--text2);}
.news-meta{font-size:10px;color:var(--text3);}
.sent-bull{color:var(--up);}.sent-bear{color:var(--down);}

/* BOARD */
.board-item{display:flex;gap:10px;padding:8px 0;border-bottom:1px solid var(--border);}
.board-item:last-child{border-bottom:none;}
.board-av{width:34px;height:34px;border-radius:50%;flex-shrink:0;background:linear-gradient(135deg,var(--accent),var(--accent2));display:flex;align-items:center;justify-content:center;font-family:'Roboto Mono',monospace;font-size:11px;font-weight:700;color:#fff;}
.board-name{font-size:12px;font-weight:600;margin-bottom:1px;}
.board-role{font-size:10px;color:var(--accent2);margin-bottom:3px;}
.board-bio{font-size:10px;color:var(--text2);line-height:1.5;}
.board-score{font-family:'Roboto Mono',monospace;font-size:10px;color:var(--gold);font-weight:600;}

/* VALUATION */
.val-grid{display:grid;grid-template-columns:1fr 1fr;gap:6px;}
.val-item{background:var(--bg3);border:1px solid var(--border);border-radius:3px;padding:8px 10px;}
.val-label{font-size:9px;color:var(--text3);text-transform:uppercase;letter-spacing:.5px;margin-bottom:2px;}
.val-val{font-family:'Roboto Mono',monospace;font-size:16px;font-weight:600;}
.val-badge{font-size:9px;margin-top:1px;font-weight:600;}

/* UNUSUAL */
.unusual-item{padding:8px 0;border-bottom:1px solid var(--border);}
.unusual-item:last-child{border-bottom:none;}
.u-top{display:flex;justify-content:space-between;align-items:center;margin-bottom:3px;}
.u-sym{font-family:'Roboto Mono',monospace;font-size:12px;font-weight:600;}
.u-type{font-size:9px;font-weight:700;padding:2px 5px;border-radius:2px;text-transform:uppercase;}
.call{background:rgba(38,166,154,.15);color:var(--up);}
.put{background:rgba(239,83,80,.15);color:var(--down);}
.u-prem{font-family:'Roboto Mono',monospace;font-size:11px;color:var(--warn);font-weight:600;}
.u-detail{font-family:'Roboto Mono',monospace;font-size:9px;color:var(--text2);}

/* OPPORTUNITIES */
.opp-card{background:var(--bg3);border:1px solid var(--border);border-radius:4px;padding:11px;margin-bottom:7px;cursor:pointer;}
.opp-card:hover{border-color:var(--accent);}
.opp-top{display:flex;justify-content:space-between;align-items:flex-start;margin-bottom:6px;}
.opp-sym{font-family:'Roboto Mono',monospace;font-size:14px;font-weight:700;color:var(--gold);}
.opp-name{font-size:10px;color:var(--text3);margin-top:1px;}
.opp-up{font-family:'Roboto Mono',monospace;font-size:13px;font-weight:700;color:var(--up);}
.opp-reason{font-size:11px;color:var(--text2);line-height:1.5;}
.opp-tags{display:flex;gap:4px;flex-wrap:wrap;margin-top:6px;}
.opp-tag{font-size:9px;padding:2px 6px;border-radius:2px;font-weight:500;background:rgba(41,98,255,.12);color:var(--accent);border:1px solid rgba(41,98,255,.2);}
.jk-banner{background:var(--bg3);border:1px solid rgba(245,158,11,.3);border-radius:4px;padding:12px;margin-bottom:8px;text-align:center;}
.jk-title{font-family:'Roboto Mono',monospace;font-size:13px;font-weight:700;color:var(--gold);margin-bottom:3px;}
.sec-div{font-size:10px;font-weight:500;letter-spacing:1.5px;color:var(--text3);text-transform:uppercase;margin:12px 0 7px;}

/* BOTTOM NAV */
.bottom-nav{position:fixed;bottom:0;left:0;right:0;z-index:100;background:var(--header);border-top:1px solid var(--border);display:flex;padding-bottom:env(safe-area-inset-bottom);}
.bnav{flex:1;display:flex;flex-direction:column;align-items:center;gap:2px;padding:8px 0;cursor:pointer;color:var(--text3);font-size:9px;font-weight:500;text-transform:uppercase;}
.bnav.active{color:var(--accent);}
.bnav-icon{font-size:18px;line-height:1;}

/* MODAL */
.modal-overlay{position:fixed;inset:0;z-index:200;background:var(--overlay);backdrop-filter:blur(8px);display:flex;align-items:flex-end;opacity:0;pointer-events:none;transition:opacity .2s;}
.modal-overlay.open{opacity:1;pointer-events:all;}
.modal{background:var(--modal-bg);border:1px solid var(--border2);border-radius:8px 8px 0 0;padding:16px;width:100%;max-height:88vh;overflow-y:auto;transform:translateY(100%);transition:transform .25s cubic-bezier(.4,0,.2,1);}
.modal-overlay.open .modal{transform:translateY(0);}
.modal-handle{width:32px;height:3px;background:var(--border2);border-radius:2px;margin:0 auto 14px;}
.modal-title{font-size:15px;font-weight:600;margin-bottom:14px;}
input.s-input{width:100%;background:var(--input-bg);border:1px solid var(--border2);border-radius:3px;padding:10px 12px;color:var(--text);font-family:'Roboto Mono',monospace;font-size:13px;outline:none;text-transform:uppercase;}
input.s-input::placeholder{text-transform:none;font-family:'Roboto',sans-serif;color:var(--text3);font-size:12px;}
input.s-input:focus{border-color:var(--accent);box-shadow:0 0 0 2px rgba(41,98,255,.1);}
.exch-chips{display:flex;gap:5px;overflow-x:auto;scrollbar-width:none;margin:8px 0;padding-bottom:2px;}
.exch-chips::-webkit-scrollbar{display:none;}
.exch-btn{padding:4px 10px;border-radius:14px;font-size:9px;font-weight:600;white-space:nowrap;cursor:pointer;border:1px solid var(--border);color:var(--text3);background:transparent;}
.exch-btn.active{background:rgba(41,98,255,.15);color:var(--accent);border-color:var(--accent);}
.sri{display:flex;align-items:center;justify-content:space-between;padding:8px;border-radius:3px;cursor:pointer;margin-bottom:2px;}
.sri:hover{background:var(--bg3);}
.sri-l{display:flex;align-items:center;gap:9px;flex:1;min-width:0;}
.sri-flag{font-size:17px;flex-shrink:0;}
.sri-sym{font-family:'Roboto Mono',monospace;font-size:12px;font-weight:600;color:var(--text);}
.sri-name{font-size:10px;color:var(--text2);overflow:hidden;text-overflow:ellipsis;white-space:nowrap;max-width:160px;}
.sri-exch{font-size:9px;color:var(--text3);}
.sri-add{font-size:9px;font-weight:600;padding:3px 8px;border-radius:2px;background:rgba(41,98,255,.1);color:var(--accent);border:1px solid rgba(41,98,255,.3);cursor:pointer;}
.sri-add.added{background:rgba(38,166,154,.1);color:var(--up);border-color:rgba(38,166,154,.3);}
.search-empty{text-align:center;padding:24px;color:var(--text3);font-size:12px;}
.wl-chip{display:flex;align-items:center;gap:3px;padding:3px 8px;background:var(--bg3);border:1px solid var(--border);border-radius:14px;font-size:10px;font-family:'Roboto Mono',monospace;color:var(--text2);cursor:pointer;}
.wl-chip .rm{color:var(--down);font-size:12px;}

/* SETTINGS */
.settings-panel{display:flex;flex-direction:column;gap:10px;}
.setting-group{background:var(--card);border:1px solid var(--border);border-radius:4px;padding:12px;}
.sgt{font-size:11px;font-weight:600;text-transform:uppercase;letter-spacing:1px;color:var(--text2);margin-bottom:10px;display:flex;justify-content:space-between;align-items:center;}
.s-row{display:flex;align-items:center;justify-content:space-between;padding:7px 0;border-bottom:1px solid var(--border);}
.s-row:last-child{border-bottom:none;}
.s-lbl{font-size:12px;color:var(--text);}
.s-desc{font-size:10px;color:var(--text3);margin-top:1px;}
.theme-btns{display:flex;gap:5px;}
.t-btn{padding:5px 10px;border-radius:3px;font-size:11px;font-weight:500;cursor:pointer;border:1px solid var(--border);color:var(--text2);background:var(--bg3);}
.t-btn.active{background:var(--accent);color:#fff;border-color:var(--accent);}
.toggle{position:relative;width:36px;height:20px;flex-shrink:0;}
.toggle input{opacity:0;width:0;height:0;}
.tslider{position:absolute;inset:0;background:var(--bg4);border-radius:10px;cursor:pointer;transition:.3s;}
.tslider::before{content:'';position:absolute;height:14px;width:14px;left:3px;bottom:3px;background:var(--text3);border-radius:50%;transition:.3s;}
.toggle input:checked+.tslider{background:var(--accent);}
.toggle input:checked+.tslider::before{transform:translateX(16px);background:#fff;}
.wl-group-row{display:flex;align-items:center;justify-content:space-between;padding:7px 0;border-bottom:1px solid var(--border);}
.wl-group-row:last-child{border-bottom:none;}
.wg-name{font-family:'Roboto Mono',monospace;font-size:11px;font-weight:600;color:var(--text);}
.wg-cnt{font-size:10px;color:var(--text3);}
.wg-actions{display:flex;gap:5px;}
.badge-dot{width:7px;height:7px;border-radius:50%;}

.skeleton{background:linear-gradient(90deg,var(--bg3) 25%,var(--bg4) 50%,var(--bg3) 75%);background-size:200% 100%;animation:shimmer 1.5s infinite;border-radius:3px;}
@keyframes shimmer{0%{background-position:200% 0}100%{background-position:-200% 0}}
.view{display:none;}.view.active{display:block;}
.t-up{color:var(--up);}.t-down{color:var(--down);}.t-warn{color:var(--warn);}.t-acc{color:var(--accent);}
</style>
</head>
<body>
<div id="app">

<header>
  <div class="logo">
    <div class="logo-mark">Œ±</div>
    <div class="logo-name">ALPHA<span>TERMINAL</span></div>
  </div>
  <div class="h-right">
    <div class="live-pill"><div class="live-dot"></div><div class="live-lbl">CANLI</div></div>
    <div class="h-clock" id="clock">--:--:--</div>
    <button class="h-btn" onclick="switchView('settings')" title="Ayarlar">‚öôÔ∏è</button>
  </div>
</header>

<div class="ticker-bar" id="tickerBar"></div>

<nav>
  <div class="tab active" data-view="watchlist">üìä ƒ∞zleme</div>
  <div class="tab" data-view="signal">‚ö° Sinyal</div>
  <div class="tab" data-view="opportunities">üéØ Fƒ±rsatlar</div>
  <div class="tab" data-view="unusual">üî• Unusual</div>
  <div class="tab" data-view="news">üåç Haber</div>
  <div class="tab" data-view="board">üëî Y√∂netim</div>
  <div class="tab" data-view="valuation">üí∞ Deƒüerleme</div>
  <div class="tab" data-view="settings">‚öôÔ∏è Ayarlar</div>
</nav>

<main>

<!-- WATCHLIST -->
<div class="view active" id="view-watchlist">
  <div class="card">
    <div class="card-hdr">
      <span>üìä ƒ∞zleme Listesi</span>
      <div style="display:flex;gap:6px;align-items:center">
        <span id="wlCount" style="font-family:'Roboto Mono',monospace;font-size:10px;color:var(--text3)">0 hisse</span>
        <button class="btn-icon" id="refreshWLBtn">‚Üª</button>
      </div>
    </div>
    <div id="watchlistItems"></div>
    <div class="add-wl-btn" id="addStockBtn"><span style="font-size:16px">+</span> Hisse Ekle</div>
  </div>
  <div class="card">
    <div class="card-hdr">
      <span>üìâ <span id="chartLbl">‚Äî</span> ¬∑ 30 G√ºnl√ºk</span>
      <span id="chartPrLbl" style="font-family:'Roboto Mono',monospace;font-size:11px;color:var(--text2)"></span>
    </div>
    <canvas class="minichart" id="miniChart"></canvas>
    <div class="chart-meta"><span id="cLow">‚Äî</span><span style="color:var(--text3)">30G</span><span id="cHigh">‚Äî</span></div>
  </div>
  <div class="card">
    <div class="card-hdr"><span>üå°Ô∏è Piyasa √ñzeti</span><span id="mktTs" style="font-family:'Roboto Mono',monospace;font-size:9px;color:var(--text3)"></span></div>
    <div class="mkt-grid" id="mktGrid">
      <div class="mkt-item"><div class="mkt-label">S&amp;P 500 (SPY)</div><div class="mkt-val skeleton" style="height:18px;width:60px;margin:2px 0"></div></div>
      <div class="mkt-item"><div class="mkt-label">VIX (VXX)</div><div class="mkt-val skeleton" style="height:18px;width:60px;margin:2px 0"></div></div>
      <div class="mkt-item"><div class="mkt-label">DXY (UUP)</div><div class="mkt-val skeleton" style="height:18px;width:60px;margin:2px 0"></div></div>
      <div class="mkt-item"><div class="mkt-label">10Y (TLT)</div><div class="mkt-val skeleton" style="height:18px;width:60px;margin:2px 0"></div></div>
    </div>
  </div>
</div>

<!-- SIGNAL -->
<div class="view" id="view-signal">
  <div class="card">
    <div class="card-hdr"><span>‚ö° Al / Sat / Bekle Sinyali</span></div>
    <div class="signal-hero">
      <div><div class="sig-lbl" id="sigTicker">Hisse se√ßin</div><div class="sig-action" id="sigAction" style="color:var(--warn)">BEKLE</div></div>
      <div><div class="sig-score-val" id="sigScore">‚Äî</div><div class="sig-score-lbl">G√ºven</div></div>
    </div>
    <div class="sig-bar-wrap"><div class="sig-bar-fill" id="sigBar" style="width:0%;background:var(--warn)"></div></div>
    <div style="font-size:10px;color:var(--text3);text-transform:uppercase;letter-spacing:1px;margin:8px 0 6px;">Sinyal Gerek√ßeleri</div>
    <div id="sigReasons"><div class="reason neutral">ƒ∞zleme listesinden bir hisse se√ßin</div></div>
  </div>
  <div class="card">
    <div class="card-hdr"><span>üìê Teknik G√∂stergeler</span><span id="techTs" style="font-family:'Roboto Mono',monospace;font-size:9px;color:var(--text3)"></span></div>
    <div class="ind-grid" id="techGrid">
      <div class="ind-item"><div class="ind-label">RSI (14)</div><div class="ind-val skeleton" style="height:20px;width:48px"></div></div>
      <div class="ind-item"><div class="ind-label">MACD</div><div class="ind-val skeleton" style="height:20px;width:48px"></div></div>
      <div class="ind-item"><div class="ind-label">Stochastic</div><div class="ind-val skeleton" style="height:20px;width:48px"></div></div>
      <div class="ind-item"><div class="ind-label">CCI (20)</div><div class="ind-val skeleton" style="height:20px;width:48px"></div></div>
      <div class="ind-item"><div class="ind-label">BB Width</div><div class="ind-val skeleton" style="height:20px;width:48px"></div></div>
      <div class="ind-item"><div class="ind-label">Momentum</div><div class="ind-val skeleton" style="height:20px;width:48px"></div></div>
    </div>
  </div>
  <div class="card">
    <div class="card-hdr"><span>üåä Fibonacci Seviyeleri</span></div>
    <table class="fib-table" id="fibTable">
      <tr><td>%23.6</td><td>‚Äî</td></tr><tr><td>%38.2</td><td>‚Äî</td></tr>
      <tr class="fib-key"><td>%61.8 Altƒ±n Oran</td><td>‚Äî</td></tr>
      <tr><td>%78.6</td><td>‚Äî</td></tr><tr><td>Ext. %161.8</td><td style="color:var(--up)">‚Äî</td></tr>
    </table>
  </div>
  <div class="card">
    <div class="card-hdr"><span>ü§ñ AI Teknik Analiz</span><span id="aiSigTs" style="font-family:'Roboto Mono',monospace;font-size:9px;color:var(--text3)"></span></div>
    <div class="ai-box">
      <div class="ai-hdr"><div class="ai-badge">Claude AI ¬∑ Anlƒ±k</div><div class="ai-dots"><div class="ai-dot"></div><div class="ai-dot"></div><div class="ai-dot"></div></div></div>
      <div class="ai-text" id="aiSigText">Analiz i√ßin hisse se√ßin.</div>
      <div class="timestamp" id="aiSigStamp"></div>
    </div>
    <button class="btn-primary" id="analyzeBtn">ü§ñ Anlƒ±k AI Analizi Yap</button>
  </div>
</div>

<!-- OPPORTUNITIES -->
<div class="view" id="view-opportunities">
  <div class="jk-banner"><div style="font-size:26px;margin-bottom:5px">üéØ</div><div class="jk-title">G√ºn√ºn Fƒ±rsatlarƒ±</div><div style="font-size:11px;color:var(--text2)">AI destekli y√ºksek potansiyel tespiti</div></div>
  <div id="oppsList"></div>
  <div class="sec-div">üíé Jackpot Radar</div>
  <div class="card">
    <div class="card-hdr"><span>üöÄ Momentum Tarayƒ±cƒ±</span></div>
    <div id="jackpotList"></div>
    <button class="btn-sec" style="width:100%;margin-top:8px" id="scanBtn">üîç Yenile</button>
  </div>
</div>

<!-- UNUSUAL -->
<div class="view" id="view-unusual">
  <div class="card">
    <div class="card-hdr"><span>üî• Unusual Opsiyon Akƒ±≈üƒ±</span><span id="unusualTs" style="font-family:'Roboto Mono',monospace;font-size:9px;color:var(--text3)"></span></div>
    <div id="unusualList"></div>
  </div>
  <div class="card">
    <div class="card-hdr"><span>üìä Opsiyon √ñzeti</span></div>
    <div class="ind-grid">
      <div class="ind-item"><div class="ind-label">Put/Call Oranƒ±</div><div class="ind-val up">0.72</div><div class="ind-status up">‚óè Bullish</div></div>
      <div class="ind-item"><div class="ind-label">Implied Vol</div><div class="ind-val t-warn">24.3%</div><div class="ind-status t-warn">‚óè Orta</div></div>
      <div class="ind-item"><div class="ind-label">Toplam Prim</div><div class="ind-val t-warn">$2.4M</div><div class="ind-status up">‚ñ≤ Y√ºksek</div></div>
      <div class="ind-item"><div class="ind-label">B√ºy√ºk ƒ∞≈ülem</div><div class="ind-val t-acc">47</div><div class="ind-status">Bug√ºn</div></div>
    </div>
  </div>
</div>

<!-- NEWS -->
<div class="view" id="view-news">
  <div class="card">
    <div class="card-hdr">
      <span>üåç Jeopolitik &amp; Makro AI</span>
      <button class="btn-icon" id="geoRefBtn">‚Üª G√ºncelle</button>
    </div>
    <div class="ai-box">
      <div class="ai-hdr"><div class="ai-badge">Claude AI ¬∑ Ger√ßek Zamanlƒ±</div><div class="ai-dots"><div class="ai-dot"></div><div class="ai-dot"></div><div class="ai-dot"></div></div></div>
      <div class="ai-text" id="geoText">Jeopolitik ve makroekonomik analiz i√ßin butona basƒ±n. Finnhub'dan g√ºncel haberler √ßekilerek analiz yapƒ±lacak.</div>
      <div class="timestamp" id="geoStamp"></div>
    </div>
    <button class="btn-primary" id="geoBtn">üåç Anlƒ±k Jeopolitik AI Analizi Yap</button>
  </div>
  <div class="card">
    <div class="card-hdr">
      <span>üì∞ Son Haberler (Finnhub API)</span>
      <div style="display:flex;gap:5px;align-items:center">
        <span id="newsTs" style="font-family:'Roboto Mono',monospace;font-size:9px;color:var(--text3)"></span>
        <button class="btn-icon" id="newsRefBtn">‚Üª</button>
      </div>
    </div>
    <div id="newsList"><div style="text-align:center;padding:20px;color:var(--text3);font-size:11px;">Haberler y√ºkleniyor...</div></div>
  </div>
  <div class="card">
    <div class="card-hdr"><span>‚öñÔ∏è Hukuki &amp; D√ºzenleyici</span></div>
    <div id="legalList"></div>
  </div>
</div>

<!-- BOARD -->
<div class="view" id="view-board">
  <div class="card">
    <div class="card-hdr"><span>üëî Y√∂netim Kurulu</span><span id="boardTs" style="font-family:'Roboto Mono',monospace;font-size:9px;color:var(--text3)"></span></div>
    <div style="font-size:11px;color:var(--text3);margin-bottom:8px;">Hisse se√ßin ‚Üí Y√∂neticiler + ge√ßmi≈üleri + etki analizi (Finnhub API)</div>
    <div id="boardList"></div>
    <button class="btn-primary" style="margin-top:8px" id="boardAnalyzeBtn">ü§ñ Y√∂netim AI Analizi</button>
  </div>
  <div class="card">
    <div class="card-hdr"><span>üìã Insider Trading (Anlƒ±k)</span><span id="insiderTs" style="font-family:'Roboto Mono',monospace;font-size:9px;color:var(--text3)"></span></div>
    <div id="insiderList"><div style="text-align:center;padding:16px;color:var(--text3);font-size:11px;">Hisse se√ßin...</div></div>
  </div>
</div>

<!-- VALUATION -->
<div class="view" id="view-valuation">
  <div class="card">
    <div class="card-hdr"><span>üí∞ Temel Deƒüerleme (Finnhub)</span><span id="valTicker" style="font-family:'Roboto Mono',monospace;font-size:10px;color:var(--text2)"></span></div>
    <div class="val-grid" id="valGrid">
      <div class="val-item"><div class="val-label">P/E</div><div class="val-val skeleton" style="height:20px;width:48px"></div></div>
      <div class="val-item"><div class="val-label">P/B</div><div class="val-val skeleton" style="height:20px;width:48px"></div></div>
      <div class="val-item"><div class="val-label">EV/EBITDA</div><div class="val-val skeleton" style="height:20px;width:48px"></div></div>
      <div class="val-item"><div class="val-label">PEG</div><div class="val-val skeleton" style="height:20px;width:48px"></div></div>
      <div class="val-item"><div class="val-label">Br√ºt Marj</div><div class="val-val skeleton" style="height:20px;width:48px"></div></div>
      <div class="val-item"><div class="val-label">Net Marj</div><div class="val-val skeleton" style="height:20px;width:48px"></div></div>
    </div>
  </div>
  <div class="card">
    <div class="card-hdr"><span>ü§ñ Deƒüerleme AI Yorumu</span><span id="valAiTs" style="font-family:'Roboto Mono',monospace;font-size:9px;color:var(--text3)"></span></div>
    <div class="ai-box"><div class="ai-text" id="valAI">Deƒüerleme analizi i√ßin hisse se√ßin.</div></div>
    <button class="btn-primary" style="margin-top:8px" id="valBtn">üí∞ Anlƒ±k Deƒüerleme Analizi</button>
  </div>
</div>

<!-- SETTINGS -->
<div class="view" id="view-settings">
  <div class="settings-panel">
    <div style="font-size:11px;font-weight:500;text-transform:uppercase;letter-spacing:1px;color:var(--text2);margin-bottom:4px;">‚öôÔ∏è Uygulama Ayarlarƒ±</div>

    <!-- Theme -->
    <div class="setting-group">
      <div class="sgt">G√∂r√ºn√ºm Temasƒ±</div>
      <div class="s-row">
        <div><div class="s-lbl">Renk Temasƒ±</div><div class="s-desc">TradingView tarzƒ± 3 farklƒ± tema</div></div>
        <div class="theme-btns">
          <div class="t-btn active" data-t="dark">üåë Karanlƒ±k</div>
          <div class="t-btn" data-t="dim">üåí Lo≈ü</div>
          <div class="t-btn" data-t="light">‚òÄÔ∏è A√ßƒ±k</div>
        </div>
      </div>
    </div>

    <!-- Watchlist Groups -->
    <div class="setting-group">
      <div class="sgt">
        <span>ƒ∞zleme Listeleri</span>
        <button class="btn-icon" id="addGroupBtn">+ Yeni Liste</button>
      </div>
      <div id="wlGroupsEl"></div>
    </div>

    <!-- Data -->
    <div class="setting-group">
      <div class="sgt">Veri &amp; API</div>
      <div class="s-row">
        <div><div class="s-lbl">Otomatik Yenileme (15s)</div><div class="s-desc">Fiyatlar Finnhub API'den anlƒ±k</div></div>
        <label class="toggle"><input type="checkbox" id="autoRTog" checked/><span class="tslider"></span></label>
      </div>
      <div class="s-row">
        <div><div class="s-lbl">Haber Otomatik Yenileme</div><div class="s-desc">5 dakikada bir yeniler</div></div>
        <label class="toggle"><input type="checkbox" id="newsRTog" checked/><span class="tslider"></span></label>
      </div>
      <div class="s-row" style="border:none">
        <div><div class="s-lbl">Finnhub API Durumu</div><div class="s-desc" id="apiStatusTxt">Kontrol ediliyor...</div></div>
        <div id="apiStatusDot" style="width:8px;height:8px;border-radius:50%;background:var(--text3)"></div>
      </div>
    </div>

    <!-- About -->
    <div class="setting-group">
      <div class="sgt">Hakkƒ±nda</div>
      <div class="s-row"><div class="s-lbl">AlphaTerminal v4.0</div><div style="font-size:10px;color:var(--text3)">Finnhub + Claude AI</div></div>
      <div class="s-row" style="border:none"><div class="s-lbl">Veri Kaynaklarƒ±</div><div style="font-size:10px;color:var(--text2)">Finnhub.io ¬∑ Claude Sonnet 4</div></div>
    </div>
  </div>
</div>

</main>

<div class="bottom-nav">
  <div class="bnav active" data-view="watchlist"><div class="bnav-icon">üìä</div>ƒ∞zleme</div>
  <div class="bnav" data-view="signal"><div class="bnav-icon">‚ö°</div>Sinyal</div>
  <div class="bnav" data-view="opportunities"><div class="bnav-icon">üéØ</div>Fƒ±rsat</div>
  <div class="bnav" data-view="unusual"><div class="bnav-icon">üî•</div>Unusual</div>
  <div class="bnav" data-view="news"><div class="bnav-icon">üåç</div>Haber</div>
</div>
</div>

<!-- ADD STOCK MODAL -->
<div class="modal-overlay" id="modalOverlay">
  <div class="modal">
    <div class="modal-handle"></div>
    <div class="modal-title">üåç Global Hisse Ara</div>
    <div style="position:relative;margin-bottom:8px">
      <input class="s-input" id="stockInput" placeholder="Ticker veya ≈üirket adƒ±... AAPL, Tesla, THYAO" style="width:100%;padding-right:34px"/>
      <div id="searchSpinner" style="display:none;position:absolute;right:10px;top:50%;transform:translateY(-50%)"><div class="ai-dot"></div></div>
    </div>
    <div class="exch-chips" id="exchFilter">
      <div class="exch-btn active" data-exch="ALL">T√ºm√º</div>
      <div class="exch-btn" data-exch="NASDAQ">üá∫üá∏ NASDAQ</div>
      <div class="exch-btn" data-exch="NYSE">üá∫üá∏ NYSE</div>
      <div class="exch-btn" data-exch="LSE">üá¨üáß Londra</div>
      <div class="exch-btn" data-exch="XETR">üá©üá™ Frankfurt</div>
      <div class="exch-btn" data-exch="TSE">üáØüáµ Tokyo</div>
      <div class="exch-btn" data-exch="NSE">üáÆüá≥ Hindistan</div>
      <div class="exch-btn" data-exch="BIST">üáπüá∑ ƒ∞stanbul</div>
    </div>
    <div id="searchResults" style="max-height:36vh;overflow-y:auto;scrollbar-width:none;"></div>
    <div id="popSection">
      <div style="font-size:10px;color:var(--text3);text-transform:uppercase;letter-spacing:1px;margin-bottom:7px;">‚ö° Pop√ºler</div>
      <div style="display:flex;flex-wrap:wrap;gap:5px" id="quickAdd"></div>
    </div>
    <div style="margin-top:12px;border-top:1px solid var(--border);padding-top:12px;">
      <div style="font-size:10px;color:var(--text3);text-transform:uppercase;letter-spacing:1px;margin-bottom:7px;">üìã ƒ∞zleme Listesi</div>
      <div id="wlManage" style="display:flex;flex-wrap:wrap;gap:5px;"></div>
    </div>
  </div>
</div>

<script>
// ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê
// CONFIG & STATE
// ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê
const FK='d6ctgkpr01qgk7mjnqu0d6ctgkpr01qgk7mjnqug';
const WL_KEY='alpha_wl_v4', CFG_KEY='alpha_cfg_v4';
const QUICK=['AAPL','TSLA','NVDA','MSFT','META','GOOGL','AMZN','JPM','PLTR','ARM'];

let wl=(()=>{try{return JSON.parse(localStorage.getItem(WL_KEY))||['AAPL','TSLA','NVDA'];}catch(e){return['AAPL','TSLA','NVDA'];}})();
let cfg=(()=>{try{return JSON.parse(localStorage.getItem(CFG_KEY))||{theme:'dark',autoR:true};}catch(e){return{theme:'dark',autoR:true};}})();
let sel=wl[0]||'AAPL', curView='watchlist', activeExch='ALL', searchTimer=null;
let wlGroups=(()=>{try{return JSON.parse(localStorage.getItem('alpha_groups'))||[{id:'g1',name:'Ana Liste'}];}catch(e){return [{id:'g1',name:'Ana Liste'}];}})();
let refreshTimer=null;

// ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê
// STATIC DATA
// ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê
const FB_STOCKS={
  AAPL:{name:'Apple Inc.',price:189.30,changePct:0.66,base:175},
  TSLA:{name:'Tesla Inc.',price:248.50,changePct:-1.27,base:220},
  NVDA:{name:'NVIDIA Corp.',price:875.40,changePct:2.17,base:800},
  MSFT:{name:'Microsoft',price:420.15,changePct:0.68,base:400},
  META:{name:'Meta Platforms',price:512.80,changePct:1.46,base:480},
  GOOGL:{name:'Alphabet Inc.',price:175.60,changePct:-0.62,base:160},
  AMZN:{name:'Amazon.com',price:193.70,changePct:1.68,base:175},
  JPM:{name:'JPMorgan Chase',price:201.40,changePct:0.45,base:185},
  PLTR:{name:'Palantir Technologies',price:24.80,changePct:3.55,base:20},
  ARM:{name:'ARM Holdings',price:118.20,changePct:1.92,base:105},
};
const FB_BOARD={
  AAPL:[
    {name:'Tim Cook',role:'CEO',ini:'TC',score:'9.2/10',bio:"2011'den beri CEO. Apple'ƒ± $3T+ piyasa deƒüerine ta≈üƒ±dƒ±. Tedarik zinciri uzmanƒ±."},
    {name:'Luca Maestri',role:'CFO',ini:'LM',score:'8.7/10',bio:"2014'ten beri CFO. $90B+ hisse geri alƒ±m. G√º√ßl√º FCF y√∂netimi."},
    {name:'Arthur Levinson',role:'Chairman',ini:'AL',score:'8.9/10',bio:"Genentech eski CEO'su. Saƒülƒ±k teknolojisi stratejisi."},
  ],
  TSLA:[
    {name:'Elon Musk',role:'CEO',ini:'EM',score:'7.1/10',bio:"Vizyoner lider. X/Twitter dikkat daƒüƒ±tƒ±cƒ± risk. Her a√ßƒ±klamasƒ± piyasayƒ± etkiliyor."},
    {name:'Vaibhav Taneja',role:'CFO',ini:'VT',score:'7.8/10',bio:"2023'ten CFO. Maliyet d√º≈ü√ºrme odaklƒ±."},
  ],
  NVDA:[
    {name:'Jensen Huang',role:'CEO/Founder',ini:'JH',score:'9.8/10',bio:"NVIDIA'yƒ± GPU'dan AI altyapƒ± devine d√∂n√º≈üt√ºrd√º. CUDA ekosistemi rakipsiz."},
    {name:'Colette Kress',role:'CFO',ini:'CK',score:'9.1/10',bio:"2013'ten CFO. Veri merkezi ge√ßi≈üini m√ºkemmel y√∂netti."},
  ],
};
const UNUSUAL_OPS=[
  {ticker:'NVDA',type:'CALL',strike:'$900',exp:'Mar 28',vol:'12,450',oi:'2,100',prem:'$8.2M',sent:'Bullish Sweep'},
  {ticker:'TSLA',type:'PUT',strike:'$230',exp:'Mar 15',vol:'8,320',oi:'1,850',prem:'$3.1M',sent:'Bearish Block'},
  {ticker:'META',type:'CALL',strike:'$530',exp:'Apr 19',vol:'5,670',oi:'890',prem:'$4.5M',sent:'Bullish Block'},
  {ticker:'AAPL',type:'CALL',strike:'$195',exp:'Mar 21',vol:'9,140',oi:'3,200',prem:'$2.8M',sent:'Bullish Sweep'},
  {ticker:'PLTR',type:'CALL',strike:'$28',exp:'Apr 5',vol:'18,900',oi:'4,100',prem:'$1.2M',sent:'Unusual Bullish'},
];
const LEGAL_DATA=[
  {title:"DOJ Anti-tekel davasƒ±: Google arama monopol√º kararƒ± bekleniyor",impact:'high',tickers:['GOOGL']},
  {title:"SEC: Kripto hisseleri i√ßin yeni a√ßƒ±klama zorunluluƒüu",impact:'med',tickers:['COIN','MSTR']},
  {title:"Meta Platforms: AB'den ‚Ç¨1.2B veri gizliliƒüi cezasƒ±",impact:'high',tickers:['META']},
  {title:"NVDA: √áin'e ihracat kƒ±sƒ±tlamalarƒ± geni≈üleyebilir",impact:'high',tickers:['NVDA']},
];
const OPPS=[
  {ticker:'PLTR',name:'Palantir Tech.',up:'+34%',reason:'AI h√ºk√ºmet s√∂zle≈ümeleri artƒ±yor. AIP platformu g√º√ßl√º momentum. Federal b√ºt√ßede √∂ncelikli.',tags:['AI','GOV','Momentum']},
  {ticker:'NVDA',name:'NVIDIA Corp.',up:'+28%',reason:'Blackwell GPU talebi arz kapasitesinin √ºzerinde. Veri merkezi b√ºy√ºmesi hƒ±zlanƒ±yor. Rakipsiz CUDA ekosistemi.',tags:['AI','Data Center']},
  {ticker:'META',name:'Meta Platforms',up:'+22%',reason:'Reklam geliri beklentileri a≈üƒ±yor. Llama AI g√º√ßl√º. Ucuz deƒüerleme + g√º√ßl√º FCF √ºretimi.',tags:['Social','AI','Value']},
];
const JACKPOT=[
  {ticker:'SMCI',name:'Super Micro Computer',reason:'AI sunucu patlamasƒ±, RSI dipten d√∂n√º≈ü, insider alƒ±m',pct:'+67%',risk:'Y√úKSEK'},
  {ticker:'ARM',name:'ARM Holdings',reason:'AI √ßiplerinde ARM mimarisi dominant. Lisans geliri patlƒ±yor.',pct:'+45%',risk:'ORTA'},
  {ticker:'IONQ',name:'IonQ Inc.',reason:'Kuantum bilgisayar erken faz. Microsoft & AWS ortaklƒ±klarƒ±.',pct:'+120%',risk:'√áOK Y√úKSEK'},
];

// ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê
// LOCAL DB
// ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê
const LOCAL_DB=[
  {s:'AAPL',n:'Apple Inc.',e:'NASDAQ',t:'üá∫üá∏'},{s:'MSFT',n:'Microsoft Corporation',e:'NASDAQ',t:'üá∫üá∏'},
  {s:'GOOGL',n:'Alphabet Inc.',e:'NASDAQ',t:'üá∫üá∏'},{s:'AMZN',n:'Amazon.com Inc.',e:'NASDAQ',t:'üá∫üá∏'},
  {s:'NVDA',n:'NVIDIA Corporation',e:'NASDAQ',t:'üá∫üá∏'},{s:'META',n:'Meta Platforms Inc.',e:'NASDAQ',t:'üá∫üá∏'},
  {s:'TSLA',n:'Tesla Inc.',e:'NASDAQ',t:'üá∫üá∏'},{s:'AVGO',n:'Broadcom Inc.',e:'NASDAQ',t:'üá∫üá∏'},
  {s:'ORCL',n:'Oracle Corporation',e:'NYSE',t:'üá∫üá∏'},{s:'AMD',n:'Advanced Micro Devices',e:'NASDAQ',t:'üá∫üá∏'},
  {s:'INTC',n:'Intel Corporation',e:'NASDAQ',t:'üá∫üá∏'},{s:'QCOM',n:'Qualcomm Inc.',e:'NASDAQ',t:'üá∫üá∏'},
  {s:'ARM',n:'Arm Holdings plc',e:'NASDAQ',t:'üá∫üá∏'},{s:'ASML',n:'ASML Holding N.V.',e:'NASDAQ',t:'üá≥üá±'},
  {s:'JPM',n:'JPMorgan Chase & Co.',e:'NYSE',t:'üá∫üá∏'},{s:'BAC',n:'Bank of America',e:'NYSE',t:'üá∫üá∏'},
  {s:'GS',n:'Goldman Sachs Group',e:'NYSE',t:'üá∫üá∏'},{s:'MS',n:'Morgan Stanley',e:'NYSE',t:'üá∫üá∏'},
  {s:'V',n:'Visa Inc.',e:'NYSE',t:'üá∫üá∏'},{s:'MA',n:'Mastercard Inc.',e:'NYSE',t:'üá∫üá∏'},
  {s:'BRK.B',n:'Berkshire Hathaway B',e:'NYSE',t:'üá∫üá∏'},{s:'PYPL',n:'PayPal Holdings',e:'NASDAQ',t:'üá∫üá∏'},
  {s:'WMT',n:'Walmart Inc.',e:'NYSE',t:'üá∫üá∏'},{s:'COST',n:'Costco Wholesale',e:'NASDAQ',t:'üá∫üá∏'},
  {s:'MCD',n:"McDonald's Corporation",e:'NYSE',t:'üá∫üá∏'},{s:'NKE',n:'Nike Inc.',e:'NYSE',t:'üá∫üá∏'},
  {s:'JNJ',n:'Johnson & Johnson',e:'NYSE',t:'üá∫üá∏'},{s:'LLY',n:'Eli Lilly',e:'NYSE',t:'üá∫üá∏'},
  {s:'XOM',n:'Exxon Mobil',e:'NYSE',t:'üá∫üá∏'},{s:'CVX',n:'Chevron Corporation',e:'NYSE',t:'üá∫üá∏'},
  {s:'PLTR',n:'Palantir Technologies',e:'NYSE',t:'üá∫üá∏'},{s:'PANW',n:'Palo Alto Networks',e:'NASDAQ',t:'üá∫üá∏'},
  {s:'SNOW',n:'Snowflake Inc.',e:'NYSE',t:'üá∫üá∏'},{s:'NET',n:'Cloudflare Inc.',e:'NYSE',t:'üá∫üá∏'},
  {s:'CRWD',n:'CrowdStrike Holdings',e:'NASDAQ',t:'üá∫üá∏'},{s:'SMCI',n:'Super Micro Computer',e:'NASDAQ',t:'üá∫üá∏'},
  {s:'IONQ',n:'IonQ Inc.',e:'NYSE',t:'üá∫üá∏'},{s:'RKLB',n:'Rocket Lab USA',e:'NASDAQ',t:'üá∫üá∏'},
  {s:'NFLX',n:'Netflix Inc.',e:'NASDAQ',t:'üá∫üá∏'},{s:'DIS',n:'Walt Disney Company',e:'NYSE',t:'üá∫üá∏'},
  {s:'UBER',n:'Uber Technologies',e:'NYSE',t:'üá∫üá∏'},{s:'ABNB',n:'Airbnb Inc.',e:'NASDAQ',t:'üá∫üá∏'},
  {s:'COIN',n:'Coinbase Global',e:'NASDAQ',t:'üá∫üá∏'},{s:'MSTR',n:'MicroStrategy Inc.',e:'NASDAQ',t:'üá∫üá∏'},
  {s:'SQ',n:'Block Inc.',e:'NYSE',t:'üá∫üá∏'},{s:'SHOP',n:'Shopify Inc.',e:'NYSE',t:'üá∫üá∏'},
  {s:'BABA',n:'Alibaba Group',e:'NYSE',t:'üá®üá≥'},{s:'NIO',n:'NIO Inc.',e:'NYSE',t:'üá®üá≥'},
  {s:'SONY',n:'Sony Group Corporation',e:'NYSE',t:'üáØüáµ'},{s:'TM',n:'Toyota Motor',e:'NYSE',t:'üáØüáµ'},
  {s:'SAP',n:'SAP SE',e:'NYSE',t:'üá©üá™'},{s:'AZN',n:'AstraZeneca PLC',e:'NASDAQ',t:'üá¨üáß'},
  {s:'HSBC',n:'HSBC Holdings',e:'NYSE',t:'üá¨üáß'},{s:'INFY',n:'Infosys Ltd.',e:'NYSE',t:'üáÆüá≥'},
  {s:'SPY',n:'SPDR S&P 500 ETF',e:'NYSE',t:'üá∫üá∏'},{s:'QQQ',n:'Invesco QQQ Trust',e:'NASDAQ',t:'üá∫üá∏'},
  {s:'GLD',n:'SPDR Gold Shares',e:'NYSE',t:'üá∫üá∏'},{s:'ARKK',n:'ARK Innovation ETF',e:'NYSE',t:'üá∫üá∏'},
  {s:'THYAO.IS',n:'T√ºrk Hava Yollarƒ±',e:'BIST',t:'üáπüá∑'},{s:'GARAN.IS',n:'Garanti BBVA',e:'BIST',t:'üáπüá∑'},
  {s:'KCHOL.IS',n:'Ko√ß Holding',e:'BIST',t:'üáπüá∑'},{s:'EREGL.IS',n:'Ereƒüli Demir √áelik',e:'BIST',t:'üáπüá∑'},
  {s:'BIMAS.IS',n:'Bƒ∞M Maƒüazalar',e:'BIST',t:'üáπüá∑'},{s:'AKBNK.IS',n:'Akbank T.A.≈û.',e:'BIST',t:'üáπüá∑'},
  {s:'ISCTR.IS',n:'ƒ∞≈ü Bankasƒ±',e:'BIST',t:'üáπüá∑'},{s:'TUPRS.IS',n:'T√ºpra≈ü',e:'BIST',t:'üáπüá∑'},
  {s:'PGSUS.IS',n:'Pegasus Havacƒ±lƒ±k',e:'BIST',t:'üáπüá∑'},{s:'TOASO.IS',n:'Tofa≈ü Otomobil',e:'BIST',t:'üáπüá∑'},
  {s:'SISE.IS',n:'≈ûi≈üecam',e:'BIST',t:'üáπüá∑'},{s:'VESTL.IS',n:'Vestel Elektronik',e:'BIST',t:'üáπüá∑'},
];

// ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê
// API & CACHE
// ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê
const pCache={}, cCache={}, prCache={}, finCache={}, bCache={}, inCache={};
let newsCache=[], newsTs=0;

async function finnhub(path,params={}){
  const url=new URL('https://finnhub.io/api/v1'+path);
  url.searchParams.set('token',FK);
  Object.entries(params).forEach(([k,v])=>url.searchParams.set(k,v));
  try{const r=await fetch(url.toString());if(!r.ok)return null;return await r.json();}
  catch(e){return null;}
}

async function fetchQ(t){
  const c=pCache[t];if(c&&Date.now()-c.ts<15000)return c;
  const d=await finnhub('/quote',{symbol:t});
  if(!d||!d.c||d.c===0)return c||null;
  const r={price:d.c,change:+(d.c-d.pc).toFixed(2),changePct:d.pc?+((d.c-d.pc)/d.pc*100).toFixed(2):0,
    high:d.h,low:d.l,open:d.o,prev:d.pc,ts:Date.now()};
  pCache[t]=r;return r;
}

async function fetchCandles(t){
  if(cCache[t]&&Date.now()-cCache[t].ts<3600000)return cCache[t].p;
  const now=Math.floor(Date.now()/1000);
  const d=await finnhub('/stock/candle',{symbol:t,resolution:'D',from:now-90*86400,to:now});
  if(d&&d.s==='ok'&&d.c){cCache[t]={p:d.c,ts:Date.now()};return d.c;}
  return null;
}

async function fetchProfile(t){
  if(prCache[t])return prCache[t];
  const d=await finnhub('/stock/profile2',{symbol:t});
  if(d&&d.name){prCache[t]=d;return d;}return null;
}

async function fetchFin(t){
  if(finCache[t]&&Date.now()-finCache[t].ts<3600000)return finCache[t];
  const d=await finnhub('/stock/metric',{symbol:t,metric:'all'});
  if(!d||!d.metric)return null;
  const m=d.metric;
  const r={pe:m.peNormalizedAnnual,pb:m.pbAnnual,evEbitda:m.evEbitdaTTM,
    gross:m.grossMarginTTM,net:m.netProfitMarginTTM,beta:m.beta,
    h52:m['52WeekHigh'],l52:m['52WeekLow'],ts:Date.now()};
  finCache[t]=r;return r;
}

async function fetchNews(ticker){
  const now=Date.now();
  if(ticker){
    const today=new Date().toISOString().split('T')[0];
    const week=new Date(now-7*864e5).toISOString().split('T')[0];
    const d=await finnhub('/company-news',{symbol:ticker,from:week,to:today});
    return d||[];
  }
  if(newsCache.length&&now-newsTs<300000)return newsCache;
  const d=await finnhub('/news',{category:'general'});
  if(d&&d.length){newsCache=d;newsTs=now;}
  return newsCache;
}

async function fetchBoard(t){
  if(bCache[t]&&Date.now()-bCache[t].ts<3600000)return bCache[t].d;
  const d=await finnhub('/stock/executive',{symbol:t});
  if(d&&d.executive){bCache[t]={d:d.executive,ts:Date.now()};return d.executive;}
  return null;
}

async function fetchInsider(t){
  if(inCache[t]&&Date.now()-inCache[t].ts<3600000)return inCache[t].d;
  const d=await finnhub('/stock/insider-transactions',{symbol:t});
  if(d&&d.data){inCache[t]={d:d.data.slice(0,10),ts:Date.now()};return d.data.slice(0,10);}
  return null;
}

async function callClaude(prompt){
  try{
    const r=await fetch('https://api.anthropic.com/v1/messages',{
      method:'POST',
      headers:{'Content-Type':'application/json'},
      body:JSON.stringify({
        model:'claude-sonnet-4-20250514',
        max_tokens:1000,
        messages:[{role:'user',content:prompt}]
      })
    });
    const d=await r.json();
    return d.content?.map(i=>i.text||'').join('')||'Analiz alƒ±namadƒ±.';
  }catch(e){return 'API baƒülantƒ± hatasƒ±. L√ºtfen tekrar deneyin.';}
}

// ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê
// INDICATORS
// ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê
function genOHLC(base,n=60){let p=base,d=[];for(let i=n;i>=0;i--){p=Math.max(p+(Math.random()-.47)*p*.022,base*.4);d.push(+p.toFixed(2));}return d;}
function calcRSI(p,n=14){if(p.length<n+1)return 50;let g=0,l=0;for(let i=p.length-n;i<p.length;i++){const d=p[i]-p[i-1];d>0?g+=d:l-=d;}const ag=g/n,al=l/n;return+(100-100/(1+ag/(al||.001))).toFixed(1);}
function calcMACD(p){const ema=(arr,n)=>{const k=2/(n+1);let e=arr.slice(0,n).reduce((a,b)=>a+b,0)/n;for(let i=n;i<arr.length;i++)e=arr[i]*k+e*(1-k);return e;};if(p.length<27)return 0;return+(ema(p,12)-ema(p,26)).toFixed(2);}
function calcStoch(p,n=14){const s=p.slice(-n),lo=Math.min(...s),hi=Math.max(...s);return+(((p[p.length-1]-lo)/(hi-lo||1))*100).toFixed(1);}
function calcCCI(p,n=20){const s=p.slice(-n),avg=s.reduce((a,b)=>a+b,0)/n,md=s.reduce((a,b)=>a+Math.abs(b-avg),0)/n;return+((p[p.length-1]-avg)/(.015*(md||1))).toFixed(0);}
function calcBBW(p,n=20){const s=p.slice(-n),avg=s.reduce((a,b)=>a+b,0)/n,std=Math.sqrt(s.reduce((a,b)=>a+(b-avg)**2,0)/n);return+((std*4/avg)*100).toFixed(1);}
function calcMom(p,n=10){return+(p[p.length-1]-p[p.length-1-n]).toFixed(2);}

// ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê
// HELPERS
// ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê
function fmtTime(d=new Date()){return d.toLocaleTimeString('tr-TR',{hour:'2-digit',minute:'2-digit',second:'2-digit'});}
function fmtShort(d=new Date()){return d.toLocaleDateString('tr-TR',{day:'2-digit',month:'short'})+' '+d.toLocaleTimeString('tr-TR',{hour:'2-digit',minute:'2-digit'});}
function fmtTs(ts){return new Date(ts*1000).toLocaleDateString('tr-TR',{day:'2-digit',month:'short'})+' '+new Date(ts*1000).toLocaleTimeString('tr-TR',{hour:'2-digit',minute:'2-digit'});}
function save(){localStorage.setItem(WL_KEY,JSON.stringify(wl));localStorage.setItem(CFG_KEY,JSON.stringify(cfg));localStorage.setItem('alpha_groups',JSON.stringify(wlGroups));}
function getName(t){return prCache[t]?.name||LOCAL_DB.find(d=>d.s===t)?.n||t;}

// ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê
// RENDERS
// ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê
function renderWL(){
  document.getElementById('wlCount').textContent=wl.length+' hisse';
  const el=document.getElementById('watchlistItems');
  if(!wl.length){el.innerHTML='<div style="text-align:center;padding:28px;color:var(--text3);font-size:11px;">ƒ∞zleme listeniz bo≈ü.<br>+ Hisse Ekle butonuna basƒ±n.</div>';return;}
  el.innerHTML=wl.map(t=>{
    const q=pCache[t],up=(q?.changePct||0)>=0;
    const price=q?'$'+q.price.toFixed(2):'‚Äî';
    const chg=q?(up?'+':'')+q.changePct.toFixed(2)+'%':'‚Äî';
    const prices=cCache[t]?.p;
    let sa='‚Äî',sc='sig-hold';
    if(prices&&prices.length>20){
      const r=calcRSI(prices),m=calcMACD(prices);let b=0,be=0;
      if(r<35)b+=2;else if(r>65)be+=2;
      if(m>0)b+=2;else be+=2;
      if((q?.changePct||0)>1)b+=1;else if((q?.changePct||0)<-1)be+=1;
      if(b>be+1){sa='AL';sc='sig-buy';}else if(be>b+1){sa='SAT';sc='sig-sell';}else{sa='BEKLE';sc='sig-hold';}
    }
    return `<div class="wl-item${sel===t?' selected':''}" onclick="selTicker('${t}')">
      <div><div class="wl-sym">${t}</div><div class="wl-name">${getName(t)}</div></div>
      <div style="text-align:right">
        <div class="wl-price${q?(up?' up':' down'):''}">${price}</div>
        <div style="display:flex;gap:3px;align-items:center;justify-content:flex-end;margin-top:2px">
          <div class="wl-chg${up?' up':' down'}">${chg}</div>
          <div class="sig-badge ${sc}">${sa}</div>
        </div>
      </div>
    </div>`;
  }).join('');
}

function renderTB(){
  document.getElementById('tickerBar').innerHTML=wl.slice(0,12).map(t=>{
    const q=pCache[t],up=(q?.changePct||0)>=0;
    return `<div class="tb-item${sel===t?' active':''}" onclick="selTicker('${t}')">
      <div class="tb-sym">${t}</div>
      <div class="tb-price${q?(up?' up':' down'):''}">${q?'$'+q.price.toFixed(2):'‚Äî'}</div>
      <div class="tb-chg${up?' up':' down'}">${q?(up?'‚ñ≤':'‚ñº')+Math.abs(q.changePct).toFixed(2)+'%':'‚Äî'}</div>
    </div>`;
  }).join('');
}

async function renderChart(t){
  document.getElementById('chartLbl').textContent=t;
  document.getElementById('chartPrLbl').textContent='‚ü≥';
  let prices=cCache[t]?.p||await fetchCandles(t);
  if(!prices||prices.length<2)prices=genOHLC(FB_STOCKS[t]?.base||100,30);
  prices=prices.slice(-30);
  const canvas=document.getElementById('miniChart');
  const dpr=window.devicePixelRatio||1;
  const W=canvas.offsetWidth,H=canvas.offsetHeight||90;
  canvas.width=W*dpr;canvas.height=H*dpr;
  const ctx=canvas.getContext('2d');ctx.scale(dpr,dpr);
  const mn=Math.min(...prices),mx=Math.max(...prices),rng=mx-mn||1;
  ctx.clearRect(0,0,W,H);
  const up=prices[prices.length-1]>=prices[0];
  const colH=up?'#26a69a':'#ef5350';
  const grad=ctx.createLinearGradient(0,0,0,H);
  grad.addColorStop(0,up?'rgba(38,166,154,.18)':'rgba(239,83,80,.18)');
  grad.addColorStop(1,'rgba(0,0,0,0)');
  const pts=prices.map((p,i)=>({x:(i/(prices.length-1))*(W-2)+1,y:H-((p-mn)/rng)*(H-14)-7}));
  ctx.beginPath();pts.forEach((pt,i)=>i?ctx.lineTo(pt.x,pt.y):ctx.moveTo(pt.x,pt.y));
  ctx.lineTo(W,H);ctx.lineTo(0,H);ctx.closePath();ctx.fillStyle=grad;ctx.fill();
  ctx.beginPath();pts.forEach((pt,i)=>i?ctx.lineTo(pt.x,pt.y):ctx.moveTo(pt.x,pt.y));
  ctx.strokeStyle=colH;ctx.lineWidth=1.5;ctx.stroke();
  const lp=pts[pts.length-1];
  ctx.beginPath();ctx.arc(lp.x,lp.y,3,0,Math.PI*2);ctx.fillStyle=colH;ctx.fill();
  document.getElementById('cLow').textContent='L: $'+mn.toFixed(2);
  document.getElementById('cHigh').textContent='H: $'+mx.toFixed(2);
  const q=pCache[t];
  document.getElementById('chartPrLbl').textContent=q?'$'+q.price.toFixed(2)+' ('+(q.changePct>=0?'+':'')+q.changePct.toFixed(2)+'%)':'';
  renderWL();renderTB();
}

async function renderSignal(t){
  document.getElementById('sigTicker').textContent=t;
  let prices=cCache[t]?.p||await fetchCandles(t);
  if(!prices||prices.length<30)prices=genOHLC(FB_STOCKS[t]?.base||100,60);
  const rsi=calcRSI(prices),macd=calcMACD(prices),stoch=calcStoch(prices),cci=calcCCI(prices),bbw=calcBBW(prices),mom=calcMom(prices);
  const q=pCache[t]||{changePct:0};const cp=q.changePct||0;
  let b=0,be=0,reasons=[];
  if(rsi<35){b+=2;reasons.push({t:`RSI a≈üƒ±rƒ± satƒ±m (${rsi}) ‚Äî alƒ±m fƒ±rsatƒ± sinyali`,v:true});}
  else if(rsi>65){be+=2;reasons.push({t:`RSI a≈üƒ±rƒ± alƒ±m (${rsi}) ‚Äî sat uyarƒ±sƒ±`,v:false});}
  else reasons.push({t:`RSI n√∂tr b√∂lge (${rsi}) ‚Äî trend yok`,v:null});
  if(macd>0){b+=2;reasons.push({t:`MACD pozitif (${macd}) ‚Äî yukarƒ± momentum g√º√ßl√º`,v:true});}
  else{be+=2;reasons.push({t:`MACD negatif (${macd}) ‚Äî a≈üaƒüƒ± baskƒ± mevcut`,v:false});}
  if(stoch<20){b+=1;reasons.push({t:`Stochastic a≈üƒ±rƒ± satƒ±m (${stoch}) ‚Äî dip b√∂lgesi`,v:true});}
  else if(stoch>80)reasons.push({t:`Stochastic a≈üƒ±rƒ± alƒ±m (${stoch}) ‚Äî dikkatli ol`,v:false});
  if(cci<-100){b+=1;reasons.push({t:`CCI a≈üƒ±rƒ± satƒ±m (${cci})`,v:true});}
  else if(cci>100)reasons.push({t:`CCI a≈üƒ±rƒ± alƒ±m (${cci})`,v:false});
  if(cp>2){b+=1;reasons.push({t:`G√º√ßl√º g√ºnl√ºk performans (+${cp.toFixed(1)}%)`,v:true});}
  else if(cp<-2)reasons.push({t:`Zayƒ±f g√ºnl√ºk performans (${cp.toFixed(1)}%)`,v:false});
  const total=b+be,conf=total>0?Math.round((b/total)*100):50;
  let action='BEKLE',ac='var(--warn)';
  if(conf>=65&&b>be){action='AL';ac='var(--up)';}
  else if(conf<40||be>b+1){action='SAT';ac='var(--down)';}
  document.getElementById('sigAction').textContent=action;
  document.getElementById('sigAction').style.color=ac;
  document.getElementById('sigScore').textContent=conf+'%';
  const bar=document.getElementById('sigBar');
  bar.style.width=conf+'%';bar.style.background=action==='AL'?'var(--up)':action==='SAT'?'var(--down)':'var(--warn)';
  document.getElementById('sigReasons').innerHTML=reasons.map(r=>`<div class="reason${r.v===true?' bull':r.v===false?' bear':' neutral'}">${r.v===true?'‚ñ≤':r.v===false?'‚ñº':'‚óÜ'} ${r.t}</div>`).join('');
  // Tech grid
  document.getElementById('techTs').textContent=fmtShort();
  const vals=[
    {lbl:'RSI (14)',val:rsi,st:rsi<35?['A≈üƒ±rƒ± Satƒ±m','t-up']:rsi>65?['A≈üƒ±rƒ± Alƒ±m','t-down']:['N√∂tr','']},
    {lbl:'MACD',val:macd,st:macd>0?['Pozitif ‚ñ≤','t-up']:['Negatif ‚ñº','t-down']},
    {lbl:'Stochastic',val:stoch,st:stoch<20?['A≈üƒ±rƒ± Satƒ±m','t-up']:stoch>80?['A≈üƒ±rƒ± Alƒ±m','t-down']:['N√∂tr','']},
    {lbl:'CCI (20)',val:cci,st:cci<-100?['Oversold','t-up']:cci>100?['Overbought','t-down']:['N√∂tr','']},
    {lbl:'BB Width',val:bbw+'%',st:bbw>3?['Volatil','t-warn']:['Sƒ±kƒ±≈üƒ±k','']},
    {lbl:'Momentum',val:mom,st:mom>0?['Pozitif','t-up']:['Negatif','t-down']},
  ];
  document.getElementById('techGrid').innerHTML=vals.map(v=>`<div class="ind-item">
    <div class="ind-label">${v.lbl}</div>
    <div class="ind-val ${v.val>=0?'t-up':'t-down'}">${v.val}</div>
    <div class="ind-status ${v.st[1]}">${v.st[0]}</div>
  </div>`).join('');
  // Fibonacci
  const high=Math.max(...prices.slice(-90)),low=Math.min(...prices.slice(-90)),range=high-low;
  const fibLevels=[[0.236,high-range*.236],[0.382,high-range*.382],[0.618,high-range*.618],[0.786,high-range*.786],[1.618,low-range*.618]];
  document.getElementById('fibTable').innerHTML=`
    <tr><td>%23.6</td><td>$${fibLevels[0][1].toFixed(2)}</td></tr>
    <tr><td>%38.2</td><td>$${fibLevels[1][1].toFixed(2)}</td></tr>
    <tr class="fib-key"><td>%61.8 Altƒ±n Oran</td><td>$${fibLevels[2][1].toFixed(2)}</td></tr>
    <tr><td>%78.6</td><td>$${fibLevels[3][1].toFixed(2)}</td></tr>
    <tr><td>Ext. %161.8</td><td style="color:var(--up)">$${fibLevels[4][1].toFixed(2)}</td></tr>`;
}

async function renderValuation(t){
  document.getElementById('valTicker').textContent=t;
  document.getElementById('valAiTs').textContent='';
  const fin=await fetchFin(t);
  const pr=await fetchProfile(t);
  const q=pCache[t];
  const fmt=v=>v!=null?v.toFixed(1):'N/A';
  const badge=(v,low,high,inv)=>{
    if(v==null)return '';
    const cheap=inv?(v>high):(v<low),exp=inv?(v<low):(v>high);
    if(cheap)return '<div class="val-badge t-up">‚úì Ucuz</div>';
    if(exp)return '<div class="val-badge t-down">‚úó Pahalƒ±</div>';
    return '<div class="val-badge" style="color:var(--text3)">‚Äî N√∂tr</div>';
  };
  document.getElementById('valGrid').innerHTML=`
    <div class="val-item"><div class="val-label">P/E</div><div class="val-val${fin?.pe>0?(fin.pe<20?' t-up':fin.pe>40?' t-down':''):''}">${fmt(fin?.pe)}</div>${badge(fin?.pe,0,30,false)}</div>
    <div class="val-item"><div class="val-label">P/B</div><div class="val-val">${fmt(fin?.pb)}</div>${badge(fin?.pb,0,3,false)}</div>
    <div class="val-item"><div class="val-label">EV/EBITDA</div><div class="val-val">${fmt(fin?.evEbitda)}</div>${badge(fin?.evEbitda,0,20,false)}</div>
    <div class="val-item"><div class="val-label">Beta</div><div class="val-val${fin?.beta>1.5?' t-warn':''}">${fmt(fin?.beta)}</div></div>
    <div class="val-item"><div class="val-label">Br√ºt Marj</div><div class="val-val${fin?.gross>40?' t-up':''}">${fin?.gross!=null?fin.gross.toFixed(1)+'%':'N/A'}</div></div>
    <div class="val-item"><div class="val-label">Net Marj</div><div class="val-val${fin?.net>15?' t-up':fin?.net<0?' t-down':''}">${fin?.net!=null?fin.net.toFixed(1)+'%':'N/A'}</div></div>`;
  document.getElementById('valAI').textContent=`${t} i√ßin deƒüerleme verisi Finnhub'dan alƒ±ndƒ±. AI yorumu i√ßin butona basƒ±n.`;
}

async function renderBoard(t){
  document.getElementById('boardTs').textContent=fmtShort();
  let execs=await fetchBoard(t);
  if(!execs||!execs.length)execs=FB_BOARD[t]||[];
  if(execs.length){
    document.getElementById('boardList').innerHTML=execs.slice(0,5).map(e=>{
      const ini=(e.name||e.name||'?').split(' ').map(x=>x[0]).slice(0,2).join('');
      const fbE=FB_BOARD[t]?.find(f=>f.name===e.name);
      return `<div class="board-item">
        <div class="board-av">${ini}</div>
        <div>
          <div class="board-name">${e.name||'‚Äî'}</div>
          <div class="board-role">${e.title||e.role||'‚Äî'}</div>
          <div class="board-bio">${fbE?.bio||'Y√∂netici bilgisi Finnhub\'dan alƒ±nmƒ±≈ütƒ±r.'}</div>
          ${fbE?`<div class="board-score">‚≠ê ${fbE.score}</div>`:''}
        </div>
      </div>`;
    }).join('');
  } else {
    document.getElementById('boardList').innerHTML='<div style="text-align:center;padding:16px;color:var(--text3);font-size:11px;">Bu hisse i√ßin y√∂netici verisi bulunamadƒ±.</div>';
  }
  // Insider
  document.getElementById('insiderTs').textContent=fmtShort();
  const ins=await fetchInsider(t);
  if(ins&&ins.length){
    document.getElementById('insiderList').innerHTML=ins.map(i=>{
      const buy=i.transactionType&&i.transactionType.toLowerCase().includes('buy');
      return `<div style="display:flex;justify-content:space-between;padding:6px 0;border-bottom:1px solid var(--border)">
        <div>
          <div style="font-size:11px;font-weight:600">${i.name||'‚Äî'}</div>
          <div style="font-size:10px;color:var(--text3)">${i.transactionDate||'‚Äî'} ¬∑ ${i.transactionType||'‚Äî'}</div>
        </div>
        <div style="text-align:right">
          <div style="font-family:'Roboto Mono',monospace;font-size:11px;color:${buy?'var(--up)':'var(--down)'}">${buy?'+':''} ${(i.share||0).toLocaleString()} hisse</div>
          <div style="font-family:'Roboto Mono',monospace;font-size:9px;color:var(--text3)">$${i.transactionPrice||'‚Äî'}</div>
        </div>
      </div>`;
    }).join('');
  } else {
    document.getElementById('insiderList').innerHTML='<div style="text-align:center;padding:16px;color:var(--text3);font-size:11px;">Insider i≈ülem bulunamadƒ±.</div>';
  }
}

async function renderNews(){
  document.getElementById('newsTs').textContent='‚ü≥ Y√ºkleniyor...';
  const news=await fetchNews(null);
  document.getElementById('newsTs').textContent=fmtShort();
  if(!news||!news.length){
    document.getElementById('newsList').innerHTML='<div style="text-align:center;padding:16px;color:var(--text3);font-size:11px;">Haber bulunamadƒ±. API kotasƒ± dolmu≈ü olabilir.</div>';
    return;
  }
  const items=news.slice(0,15);
  document.getElementById('newsList').innerHTML=items.map(n=>{
    const sentiment=n.sentiment?.toLowerCase()||'';
    const sc=sentiment==='positive'?'sent-bull':sentiment==='negative'?'sent-bear':'';
    const url=n.url?`<a href="${n.url}" target="_blank" class="news-link">‚Üí Haberi Oku</a>`:'';
    return `<div class="news-item">
      <div class="news-top">
        <div class="news-title">${n.headline||n.summary||'‚Äî'}</div>
        <div class="imp ${n.related?.includes('NVDA')||n.related?.includes('TSLA')?'imp-high':n.category==='general'?'imp-low':'imp-med'}">${n.category||'GENEL'}</div>
      </div>
      <div class="news-meta" style="display:flex;gap:8px;align-items:center">
        <span>${n.source||'‚Äî'}</span>
        <span style="color:var(--text3)">¬∑</span>
        <span>${n.datetime?fmtTs(n.datetime):'‚Äî'}</span>
        ${sentiment?`<span class="${sc}">‚óè ${sentiment==='positive'?'Olumlu':'Olumsuz'}</span>`:''}
        ${url}
      </div>
    </div>`;
  }).join('');
}

function renderLegal(){
  document.getElementById('legalList').innerHTML=LEGAL_DATA.map(l=>`
    <div class="news-item">
      <div class="news-top">
        <div class="news-title">${l.title}</div>
        <div class="imp imp-${l.impact}">${l.impact==='high'?'KRƒ∞Tƒ∞K':l.impact==='med'?'ORTA':'D√ú≈û√úK'}</div>
      </div>
      <div class="news-meta">Etkilenen: ${l.tickers.join(', ')}</div>
    </div>`).join('');
}

function renderUnusual(){
  document.getElementById('unusualTs').textContent=fmtShort();
  document.getElementById('unusualList').innerHTML=UNUSUAL_OPS.map(u=>`
    <div class="unusual-item">
      <div class="u-top">
        <div><span class="u-sym">${u.ticker}</span><span class="u-type ${u.type==='CALL'?'call':'put'}" style="margin-left:6px">${u.type}</span></div>
        <div class="u-prem">${u.prem}</div>
      </div>
      <div class="u-detail">Strike ${u.strike} ¬∑ Exp ${u.exp} ¬∑ Vol ${u.vol} ¬∑ OI ${u.oi}</div>
      <div class="u-sent" style="color:${u.type==='CALL'?'var(--up)':'var(--down)'}">${u.sent}</div>
    </div>`).join('');
}

function renderOpps(){
  document.getElementById('oppsList').innerHTML=OPPS.map(o=>`
    <div class="opp-card" onclick="selTicker('${o.ticker}')">
      <div class="opp-top">
        <div><div class="opp-sym">${o.ticker}</div><div class="opp-name">${o.name}</div></div>
        <div class="opp-up">${o.up}</div>
      </div>
      <div class="opp-reason">${o.reason}</div>
      <div class="opp-tags">${o.tags.map(t=>`<div class="opp-tag">${t}</div>`).join('')}</div>
    </div>`).join('');
  document.getElementById('jackpotList').innerHTML=JACKPOT.map(j=>`
    <div style="display:flex;justify-content:space-between;align-items:center;padding:7px 0;border-bottom:1px solid var(--border)">
      <div>
        <div style="font-family:'Roboto Mono',monospace;font-size:12px;font-weight:600;color:var(--gold)">${j.ticker}</div>
        <div style="font-size:10px;color:var(--text3)">${j.name}</div>
        <div style="font-size:10px;color:var(--text2);margin-top:2px">${j.reason}</div>
      </div>
      <div style="text-align:right;flex-shrink:0;padding-left:8px">
        <div style="font-family:'Roboto Mono',monospace;font-size:13px;font-weight:700;color:var(--up)">${j.pct}</div>
        <div style="font-size:9px;font-weight:600;padding:2px 5px;border-radius:2px;background:rgba(239,83,80,.1);color:var(--down);margin-top:2px">${j.risk}</div>
      </div>
    </div>`).join('');
}

async function renderMarket(){
  document.getElementById('mktTs').textContent='‚ü≥';
  const tickers=['SPY','VXX','UUP','TLT'];
  const quotes=await Promise.all(tickers.map(t=>fetchQ(t)));
  const labels=['S&P 500 (SPY)','VIX (VXX)','DXY (UUP)','10Y (TLT)'];
  document.getElementById('mktGrid').innerHTML=labels.map((l,i)=>{
    const q=quotes[i];const up=(q?.changePct||0)>=0;
    return `<div class="mkt-item">
      <div class="mkt-label">${l}</div>
      <div class="mkt-val ${q?(up?'up':'down'):''}">${q?'$'+q.price.toFixed(2):'‚Äî'}</div>
      <div class="mkt-chg ${q?(up?'up':'down'):''}">${q?(up?'‚ñ≤':'‚ñº')+Math.abs(q.changePct).toFixed(2)+'%':'‚Äî'}</div>
    </div>`;
  }).join('');
  document.getElementById('mktTs').textContent=fmtShort();
}

function renderSettingsTheme(){
  document.querySelectorAll('.t-btn').forEach(b=>{b.classList.toggle('active',b.dataset.t===cfg.theme);});
}

function renderWLGroups(){
  document.getElementById('wlGroupsEl').innerHTML=wlGroups.map((g,i)=>`
    <div class="wl-group-row">
      <div><div class="wg-name">${g.name}</div><div class="wg-cnt">${wl.length} hisse</div></div>
      <div class="wg-actions">
        ${wlGroups.length>1?`<button class="btn-icon" onclick="deleteGroup(${i})" style="color:var(--down)">‚úï</button>`:''}
        <button class="btn-icon" onclick="renameGroup(${i})">‚úé</button>
      </div>
    </div>`).join('');
}

// ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê
// TICKER SELECTION
// ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê
async function selTicker(t){
  sel=t;
  renderWL();renderTB();
  const promises=[fetchQ(t)];
  if(!cCache[t])promises.push(fetchCandles(t));
  if(!prCache[t])promises.push(fetchProfile(t));
  await Promise.all(promises);
  renderChart(t);
  if(curView==='signal'){renderSignal(t);document.getElementById('sigTicker').textContent=t;}
  if(curView==='valuation'){renderValuation(t);document.getElementById('valTicker').textContent=t;}
  if(curView==='board'){renderBoard(t);}
  document.getElementById('boardTs').textContent='';
}

// ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê
// VIEW SWITCH
// ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê
function switchView(v){
  curView=v;
  document.querySelectorAll('.view').forEach(el=>el.classList.toggle('active',el.id==='view-'+v));
  document.querySelectorAll('.tab').forEach(el=>el.classList.toggle('active',el.dataset.view===v));
  document.querySelectorAll('.bnav').forEach(el=>el.classList.toggle('active',el.dataset.view===v));
  if(v==='signal'&&sel)renderSignal(sel);
  if(v==='valuation'&&sel){renderValuation(sel);}
  if(v==='board'&&sel){renderBoard(sel);}
  if(v==='news'){renderNews();renderLegal();}
  if(v==='unusual')renderUnusual();
  if(v==='opportunities')renderOpps();
  if(v==='settings'){renderSettingsTheme();renderWLGroups();}
}

// ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê
// SEARCH MODAL
// ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê
function openModal(){
  document.getElementById('modalOverlay').classList.add('open');
  renderWLManage();renderQuickAdd();
  document.getElementById('stockInput').focus();
}
function closeModal(){document.getElementById('modalOverlay').classList.remove('open');}

function renderQuickAdd(){
  document.getElementById('quickAdd').innerHTML=QUICK.map(t=>`
    <div onclick="addTicker('${t}')" style="padding:5px 9px;border-radius:14px;font-family:'Roboto Mono',monospace;font-size:10px;font-weight:600;cursor:pointer;background:${wl.includes(t)?'rgba(38,166,154,.15)':'var(--bg3)'};border:1px solid ${wl.includes(t)?'rgba(38,166,154,.4)':'var(--border)'};color:${wl.includes(t)?'var(--up)':'var(--text2)'}">${t}</div>`).join('');
}
function renderWLManage(){
  document.getElementById('wlManage').innerHTML=wl.map(t=>`
    <div class="wl-chip" onclick="removeTicker('${t}')">
      ${t} <span class="rm">‚úï</span>
    </div>`).join('');
}

function addTicker(t){
  if(!wl.includes(t)){wl.push(t);save();renderWL();renderTB();}
  renderWLManage();renderQuickAdd();
  const btn=document.querySelector(`.sri-add[data-s="${t}"]`);
  if(btn){btn.textContent='‚úì Eklendi';btn.classList.add('added');}
}
function removeTicker(t){
  wl=wl.filter(x=>x!==t);
  if(sel===t)sel=wl[0]||'';
  save();renderWL();renderTB();renderWLManage();renderQuickAdd();
}

let searchCache={};
async function doSearch(q){
  if(!q){document.getElementById('searchResults').innerHTML='';document.getElementById('popSection').style.display='';return;}
  document.getElementById('popSection').style.display='none';
  document.getElementById('searchSpinner').style.display='block';
  const up=q.toUpperCase();
  let res=LOCAL_DB.filter(d=>{
    const matchExch=activeExch==='ALL'||d.e===activeExch;
    return matchExch&&(d.s.includes(up)||d.n.toLowerCase().includes(q.toLowerCase()));
  }).slice(0,12);
  // Also try Finnhub search
  if(!searchCache[up]){
    const api=await finnhub('/search',{q:q});
    if(api&&api.result){
      searchCache[up]=api.result;
      api.result.slice(0,8).forEach(r=>{
        if(!res.find(x=>x.s===r.symbol))res.push({s:r.symbol,n:r.description||r.symbol,e:r.type||'',t:'üåê'});
      });
    }
  }
  document.getElementById('searchSpinner').style.display='none';
  if(!res.length){document.getElementById('searchResults').innerHTML='<div class="search-empty">Sonu√ß bulunamadƒ±</div>';return;}
  document.getElementById('searchResults').innerHTML=res.map(r=>`
    <div class="sri">
      <div class="sri-l">
        <span class="sri-flag">${r.t}</span>
        <div>
          <div class="sri-sym">${r.s}</div>
          <div class="sri-name">${r.n}</div>
          <div class="sri-exch">${r.e}</div>
        </div>
      </div>
      <div class="sri-add${wl.includes(r.s)?' added':''}" data-s="${r.s}" onclick="addTicker('${r.s}')">${wl.includes(r.s)?'‚úì Listede':'+ Ekle'}</div>
    </div>`).join('');
}

// ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê
// THEME
// ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê
function setTheme(t){
  cfg.theme=t;save();
  document.documentElement.setAttribute('data-theme',t);
  renderSettingsTheme();
}

// ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê
// WATCHLIST GROUPS
// ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê
function addGroup(){
  const name=prompt('Liste adƒ±:');
  if(!name||!name.trim())return;
  wlGroups.push({id:'g'+Date.now(),name:name.trim()});
  save();renderWLGroups();
}
function deleteGroup(i){
  if(wlGroups.length<=1)return;
  if(!confirm('Bu listeyi sil?'))return;
  wlGroups.splice(i,1);save();renderWLGroups();
}
function renameGroup(i){
  const name=prompt('Yeni ad:',wlGroups[i].name);
  if(!name||!name.trim())return;
  wlGroups[i].name=name.trim();save();renderWLGroups();
}

// ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê
// AI ANALYSIS
// ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê
async function aiSignalAnalysis(){
  if(!sel)return;
  const btn=document.getElementById('analyzeBtn');
  btn.textContent='‚ü≥ AI Analiz Yapƒ±yor...';btn.disabled=true;
  document.getElementById('aiSigText').textContent='Anlƒ±k veri toplanƒ±yor ve analiz yapƒ±lƒ±yor...';
  const q=pCache[sel];const fin=await fetchFin(sel);const pr=await fetchProfile(sel);
  const prices=cCache[sel]?.p||[];
  const rsi=prices.length>14?calcRSI(prices):50;
  const macd=prices.length>26?calcMACD(prices):0;
  const prompt=`Sen deneyimli bir borsa analisti ve portf√∂y y√∂neticisisin. ${sel} (${pr?.name||sel}) hissesi i√ßin kƒ±sa ve etkili bir teknik + temel analiz yap.

Anlƒ±k Veri:
- G√ºncel Fiyat: $${q?.price||'N/A'} (${q?.changePct>=0?'+':''}${q?.changePct||0}% bug√ºn)
- 52H/L: $${fin?.h52||'N/A'} / $${fin?.l52||'N/A'}
- RSI: ${rsi} | MACD: ${macd}
- P/E: ${fin?.pe||'N/A'} | Beta: ${fin?.beta||'N/A'}
- Br√ºt Marj: ${fin?.gross!=null?fin.gross.toFixed(1)+'%':'N/A'}

T√ºrk√ße olarak ≈üunlarƒ± i√ßeren 3-4 c√ºmlelik analiz yaz:
1. Kƒ±sa vadeli teknik g√∂r√ºn√ºm
2. Risk/fƒ±rsat deƒüerlendirmesi
3. Net AL/SAT/BEKLE √∂nerisi ve gerek√ßesi`;
  const res=await callClaude(prompt);
  document.getElementById('aiSigText').textContent=res;
  document.getElementById('aiSigStamp').textContent='Son g√ºncelleme: '+fmtShort();
  btn.textContent='ü§ñ Anlƒ±k AI Analizi Yap';btn.disabled=false;
}

async function geoAnalysis(){
  const btn=document.getElementById('geoBtn');
  btn.textContent='‚ü≥ Haberler ƒ∞≈üleniyor...';btn.disabled=true;
  document.getElementById('geoText').textContent='Finnhub\'dan g√ºncel haberler √ßekiliyor ve AI analiz yapƒ±lƒ±yor...';
  const news=await fetchNews(null);
  const headlines=news.slice(0,8).map(n=>n.headline||n.summary||'').filter(Boolean).join('\n');
  const prompt=`Sen deneyimli bir jeopolitik risk analisti ve makroekonomistsin. A≈üaƒüƒ±daki g√ºncel finansal haberler ƒ±≈üƒ±ƒüƒ±nda kapsamlƒ± bir jeopolitik ve makroekonomik risk analizi yap.

G√ºncel Haberler (${new Date().toLocaleDateString('tr-TR')}):
${headlines||'[Haber verisi alƒ±namadƒ±, genel analiz yap]'}

T√ºrk√ße olarak ≈üunlarƒ± analiz et:
1. En kritik 2-3 jeopolitik risk fakt√∂r√º
2. Makroekonomik ortam (faiz, enflasyon, dolar)
3. Hangi sekt√∂rler risk altƒ±nda, hangilerinde fƒ±rsat var
4. Yatƒ±rƒ±mcƒ± i√ßin net √∂zet √∂neri

Analiz 5-6 c√ºmle olsun, net ve eylem odaklƒ± olsun.`;
  const res=await callClaude(prompt);
  document.getElementById('geoText').textContent=res;
  document.getElementById('geoStamp').textContent='Haber kaynaƒüƒ±: Finnhub API ¬∑ '+fmtShort();
  btn.textContent='üåç Anlƒ±k Jeopolitik AI Analizi Yap';btn.disabled=false;
}

async function valAnalysis(){
  if(!sel)return;
  const btn=document.getElementById('valBtn');
  btn.textContent='‚ü≥ Analiz Yapƒ±lƒ±yor...';btn.disabled=true;
  const fin=await fetchFin(sel);const pr=await fetchProfile(sel);const q=pCache[sel];
  const prompt=`${sel} (${pr?.name||sel}) hissesi i√ßin deƒüerleme analizi yap.

Anlƒ±k Finansal Veriler:
- Fiyat: $${q?.price||'N/A'}
- P/E: ${fin?.pe||'N/A'} | P/B: ${fin?.pb||'N/A'} | EV/EBITDA: ${fin?.evEbitda||'N/A'}
- Br√ºt Marj: ${fin?.gross!=null?fin.gross.toFixed(1)+'%':'N/A'} | Net Marj: ${fin?.net!=null?fin.net.toFixed(1)+'%':'N/A'}
- Beta: ${fin?.beta||'N/A'} | 52H: $${fin?.h52||'N/A'} / 52L: $${fin?.l52||'N/A'}
- Sekt√∂r: ${pr?.finnhubIndustry||'N/A'}

T√ºrk√ße olarak:
1. Sekt√∂r ortalamasƒ±yla kƒ±yasla (ucuz mu, pahalƒ± mƒ±?)
2. Kaliteli i≈ü modeli mi?
3. Net deƒüerleme kararƒ± (3-4 c√ºmle)`;
  const res=await callClaude(prompt);
  document.getElementById('valAI').textContent=res;
  document.getElementById('valAiTs').textContent=fmtShort();
  btn.textContent='üí∞ Anlƒ±k Deƒüerleme Analizi';btn.disabled=false;
}

async function boardAnalysis(){
  if(!sel)return;
  const btn=document.getElementById('boardAnalyzeBtn');
  btn.textContent='‚ü≥ Analiz Yapƒ±lƒ±yor...';btn.disabled=true;
  const pr=await fetchProfile(sel);
  const ins=await fetchInsider(sel);
  const insiderSummary=ins?`Son ${ins.length} insider i≈ülem var.`:'Insider verisi yok.';
  const prompt=`${sel} (${pr?.name||sel}) ≈üirketinin y√∂netim kalitesini deƒüerlendir.

≈ûirket Profili:
- Sekt√∂r: ${pr?.finnhubIndustry||'N/A'}
- Piyasa Deƒüeri: $${pr?.marketCapitalization?Math.round(pr.marketCapitalization/1000)+'B':'N/A'}
- √úlke: ${pr?.country||'N/A'}
Insider: ${insiderSummary}

T√ºrk√ße olarak y√∂netim kalitesi, kurumsal y√∂netim riskleri ve insider aktivitesini 3-4 c√ºmlede deƒüerlendir.`;
  const res=await callClaude(prompt);
  // Show result in a toast-style div
  const existing=document.getElementById('boardAiResult');
  if(existing)existing.remove();
  const div=document.createElement('div');
  div.id='boardAiResult';
  div.className='ai-box';div.style.marginTop='8px';
  div.innerHTML=`<div class="ai-hdr"><div class="ai-badge">Claude AI ¬∑ Anlƒ±k</div></div><div class="ai-text">${res}</div><div class="timestamp">${fmtShort()}</div>`;
  document.querySelector('#view-board .card').appendChild(div);
  btn.textContent='ü§ñ Y√∂netim AI Analizi';btn.disabled=false;
}

// ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê
// API STATUS CHECK
// ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê
async function checkAPIStatus(){
  const d=await fetchQ('AAPL');
  const dot=document.getElementById('apiStatusDot');
  const txt=document.getElementById('apiStatusTxt');
  if(d&&d.price){
    dot.style.background='var(--up)';
    txt.textContent='‚úì Baƒülƒ± ¬∑ Anlƒ±k veri aktif ¬∑ '+fmtShort();
  } else {
    dot.style.background='var(--down)';
    txt.textContent='‚úó Baƒülantƒ± hatasƒ± ¬∑ API kotasƒ± dolmu≈ü olabilir';
  }
}

// ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê
// CLOCK
// ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê
setInterval(()=>{
  const now=new Date();
  document.getElementById('clock').textContent=now.toLocaleTimeString('tr-TR');
},1000);

// ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê
// AUTO REFRESH
// ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê
function startAutoRefresh(){
  if(refreshTimer)clearInterval(refreshTimer);
  refreshTimer=setInterval(async()=>{
    if(!cfg.autoR)return;
    await Promise.all(wl.map(t=>fetchQ(t)));
    renderWL();renderTB();
    if(curView==='watchlist')renderChart(sel);
    if(curView==='signal')renderSignal(sel);
  },15000);
}

// ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê
// EVENT LISTENERS
// ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê
document.querySelectorAll('.tab').forEach(el=>el.addEventListener('click',()=>switchView(el.dataset.view)));
document.querySelectorAll('.bnav').forEach(el=>el.addEventListener('click',()=>switchView(el.dataset.view)));
document.getElementById('addStockBtn').addEventListener('click',openModal);
document.getElementById('modalOverlay').addEventListener('click',e=>{if(e.target===document.getElementById('modalOverlay'))closeModal();});
document.getElementById('stockInput').addEventListener('input',e=>{
  clearTimeout(searchTimer);
  searchTimer=setTimeout(()=>doSearch(e.target.value.trim()),250);
});
document.getElementById('exchFilter').addEventListener('click',e=>{
  const btn=e.target.closest('.exch-btn');if(!btn)return;
  activeExch=btn.dataset.exch;
  document.querySelectorAll('.exch-btn').forEach(b=>b.classList.toggle('active',b.dataset.exch===activeExch));
  doSearch(document.getElementById('stockInput').value.trim());
});
document.getElementById('analyzeBtn').addEventListener('click',aiSignalAnalysis);
document.getElementById('geoBtn').addEventListener('click',geoAnalysis);
document.getElementById('geoRefBtn').addEventListener('click',()=>{newsCache=[];geoAnalysis();});
document.getElementById('newsRefBtn').addEventListener('click',()=>{newsCache=[];renderNews();});
document.getElementById('valBtn').addEventListener('click',valAnalysis);
document.getElementById('boardAnalyzeBtn').addEventListener('click',boardAnalysis);
document.getElementById('scanBtn').addEventListener('click',renderOpps);
document.getElementById('refreshWLBtn').addEventListener('click',async()=>{
  await Promise.all(wl.map(t=>{delete pCache[t];return fetchQ(t);}));
  renderWL();renderTB();if(sel)renderChart(sel);
});
document.getElementById('addGroupBtn').addEventListener('click',addGroup);
document.getElementById('autoRTog').addEventListener('change',e=>{cfg.autoR=e.target.checked;save();});
document.getElementById('newsRTog').addEventListener('change',()=>{});
document.querySelectorAll('.t-btn').forEach(b=>b.addEventListener('click',()=>setTheme(b.dataset.t)));

// ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê
// INIT
// ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê
(async()=>{
  // Apply saved theme
  document.documentElement.setAttribute('data-theme',cfg.theme);
  renderSettingsTheme();
  // Initial render
  renderWL();renderTB();renderUnusual();renderOpps();renderLegal();
  // Load live data
  const quotes=await Promise.all(wl.map(t=>fetchQ(t)));
  renderWL();renderTB();
  // Load candles + profile for selected
  if(sel){
    await Promise.all([fetchCandles(sel),fetchProfile(sel)]);
    renderChart(sel);
  }
  // Market summary
  renderMarket();
  // Load news in background
  renderNews();
  // Check API status
  checkAPIStatus();
  // Auto refresh
  startAutoRefresh();
})();
</script>
</body>
</html>
